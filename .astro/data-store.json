[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.9.2","content-config-digest","0928bc3eef41a0b7","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://prabinthakur.xyz/\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":true,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"experimentalDefaultStyles\":true},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":false,\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[null,null,null,null,null,[null,{\"maxDepth\":3}]],\"rehypePlugins\":[null,[null,{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}],[null,{\"theme\":{\"light\":\"github-light\",\"dark\":\"github-dark\"},\"keepBackground\":false}],null,null,[null,{\"properties\":{\"ariaHidden\":\"true\",\"tabIndex\":-1,\"class\":\"header-anchor\"},\"content\":{\"type\":\"text\",\"value\":\"#\"}}]],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"responsiveImages\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"csp\":false},\"legacy\":{\"collections\":false}}","blog",["Map",11,12,33,34,72,73,129,130],"2022-05-20-new-homepage",{"id":11,"data":13,"body":15,"filePath":16,"digest":17,"rendered":18},{"title":14},"New homepage","It seems that I always spend a lot of time on building my homepage.\n\nMy first homepage (or blog) was built with [Jekyll](https://jekyllrb.com/) in 2018. I wrote a [theme](https://github.com/Renovamen/jekyll-theme-gungnir) named Gungnir for it, since I found out none of the existing Jekyll themes are good enough for me. At that time, I knew almost nothing about FE and struggled a lot with JavaScript, CSS and the [Liquid](https://shopify.github.io/liquid/) templating language, leading to messy code that is difficult to maintain. In 2020, I migrated [Gungnir](https://github.com/Renovamen/vuepress-theme-gungnir/tree/v0) to [VuePress](https://vuepress.vuejs.org), a more powerful static website generator. And last year, I rewrote the [theme](https://github.com/Renovamen/vuepress-theme-gungnir) in [VuePress 2](https://v2.vuepress.vuejs.org) to take advantage of Vue 3 and Vite, which is still actively maintained.\n\nYeah, it took me so much time to develop my own blog themes that I almost forgot about writing the blog lol.\n\nThese days, again, I turned to another new homepage, which I hope is the last one (before I begin to be fed up with it again in about 2-3 years).\n\n## Style\n\nI want my homepage to be more \"research\" and \"serious\". My [old homepage](https://blog.zxh.io) looks more like a blog with a bunch of fancy images rather than a \"reacher's homepage\". Meanwhile, I wearied of looking for cover images for posts and became obsessed with simple website designs.\n\nI don't want to modify my blog theme directly since I still love its style and it already has a certain number of users. Thus I wrote a new one.\n\n## Tech stack\n\nGradually I found I got so caught up with atomic CSS frameworks like [Tailwind CSS](https://tailwindcss.com/), [Windi CSS](https://windicss.org/) and [UnoCSS](https://github.com/antfu/unocss). I'm using UnoCSS in almost all of my recent projects and I can say that I never want to write semantic class names and regular CSS anymore. Actually I was even thinking about applying UnoCSS on VuePress blog theme [Gungnir](https://github.com/Renovamen/vuepress-theme-gungnir), but it sounds a heavy work and I'm not sure if it is a right choice. But starting a new site with UnoCSS could be much eaiser - that's what I'm doing.\n\nI built my new homepage on top of [Vitesse](https://github.com/antfu/vitesse). With the power of [vite-ssg](https://github.com/antfu/vite-ssg) and several [Vite](https://github.com/vitejs/vite) plugins like [vite-plugin-pages](https://github.com/hannoeru/vite-plugin-pages), [vite-plugin-vue-layouts](https://github.com/JohnCampionJr/vite-plugin-vue-layouts) and [vite-plugin-md](https://github.com/antfu/vite-plugin-md), a personal website with a blog section can now be done in a really short time. For me, this solution is lightweight and fast, making the development experience smooth and sweet. If you just want a simple personal website or blog and don't care about maintaining a theme, I guess Vitesse could be a nice choice.\n\n---\n\nAnyway, this is site is still WIP, hoping to see what it will eventually become.","src/content/blog/2022-05-20-new-homepage.md","7760643edba994ed",{"html":19,"metadata":20},"\u003Cp>It seems that I always spend a lot of time on building my homepage.\u003C/p>\n\u003Cp>My first homepage (or blog) was built with \u003Ca href=\"https://jekyllrb.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Jekyll\u003C/a> in 2018. I wrote a \u003Ca href=\"https://github.com/Renovamen/jekyll-theme-gungnir\" rel=\"noopener noreferrer\" target=\"_blank\">theme\u003C/a> named Gungnir for it, since I found out none of the existing Jekyll themes are good enough for me. At that time, I knew almost nothing about FE and struggled a lot with JavaScript, CSS and the \u003Ca href=\"https://shopify.github.io/liquid/\" rel=\"noopener noreferrer\" target=\"_blank\">Liquid\u003C/a> templating language, leading to messy code that is difficult to maintain. In 2020, I migrated \u003Ca href=\"https://github.com/Renovamen/vuepress-theme-gungnir/tree/v0\" rel=\"noopener noreferrer\" target=\"_blank\">Gungnir\u003C/a> to \u003Ca href=\"https://vuepress.vuejs.org\" rel=\"noopener noreferrer\" target=\"_blank\">VuePress\u003C/a>, a more powerful static website generator. And last year, I rewrote the \u003Ca href=\"https://github.com/Renovamen/vuepress-theme-gungnir\" rel=\"noopener noreferrer\" target=\"_blank\">theme\u003C/a> in \u003Ca href=\"https://v2.vuepress.vuejs.org\" rel=\"noopener noreferrer\" target=\"_blank\">VuePress 2\u003C/a> to take advantage of Vue 3 and Vite, which is still actively maintained.\u003C/p>\n\u003Cp>Yeah, it took me so much time to develop my own blog themes that I almost forgot about writing the blog lol.\u003C/p>\n\u003Cp>These days, again, I turned to another new homepage, which I hope is the last one (before I begin to be fed up with it again in about 2-3 years).\u003C/p>\n\u003Ch2 id=\"style\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#style\">#\u003C/a>Style\u003C/h2>\n\u003Cp>I want my homepage to be more “research” and “serious”. My \u003Ca href=\"https://blog.zxh.io\" rel=\"noopener noreferrer\" target=\"_blank\">old homepage\u003C/a> looks more like a blog with a bunch of fancy images rather than a “reacher’s homepage”. Meanwhile, I wearied of looking for cover images for posts and became obsessed with simple website designs.\u003C/p>\n\u003Cp>I don’t want to modify my blog theme directly since I still love its style and it already has a certain number of users. Thus I wrote a new one.\u003C/p>\n\u003Ch2 id=\"tech-stack\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#tech-stack\">#\u003C/a>Tech stack\u003C/h2>\n\u003Cp>Gradually I found I got so caught up with atomic CSS frameworks like \u003Ca href=\"https://tailwindcss.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Tailwind CSS\u003C/a>, \u003Ca href=\"https://windicss.org/\" rel=\"noopener noreferrer\" target=\"_blank\">Windi CSS\u003C/a> and \u003Ca href=\"https://github.com/antfu/unocss\" rel=\"noopener noreferrer\" target=\"_blank\">UnoCSS\u003C/a>. I’m using UnoCSS in almost all of my recent projects and I can say that I never want to write semantic class names and regular CSS anymore. Actually I was even thinking about applying UnoCSS on VuePress blog theme \u003Ca href=\"https://github.com/Renovamen/vuepress-theme-gungnir\" rel=\"noopener noreferrer\" target=\"_blank\">Gungnir\u003C/a>, but it sounds a heavy work and I’m not sure if it is a right choice. But starting a new site with UnoCSS could be much eaiser - that’s what I’m doing.\u003C/p>\n\u003Cp>I built my new homepage on top of \u003Ca href=\"https://github.com/antfu/vitesse\" rel=\"noopener noreferrer\" target=\"_blank\">Vitesse\u003C/a>. With the power of \u003Ca href=\"https://github.com/antfu/vite-ssg\" rel=\"noopener noreferrer\" target=\"_blank\">vite-ssg\u003C/a> and several \u003Ca href=\"https://github.com/vitejs/vite\" rel=\"noopener noreferrer\" target=\"_blank\">Vite\u003C/a> plugins like \u003Ca href=\"https://github.com/hannoeru/vite-plugin-pages\" rel=\"noopener noreferrer\" target=\"_blank\">vite-plugin-pages\u003C/a>, \u003Ca href=\"https://github.com/JohnCampionJr/vite-plugin-vue-layouts\" rel=\"noopener noreferrer\" target=\"_blank\">vite-plugin-vue-layouts\u003C/a> and \u003Ca href=\"https://github.com/antfu/vite-plugin-md\" rel=\"noopener noreferrer\" target=\"_blank\">vite-plugin-md\u003C/a>, a personal website with a blog section can now be done in a really short time. For me, this solution is lightweight and fast, making the development experience smooth and sweet. If you just want a simple personal website or blog and don’t care about maintaining a theme, I guess Vitesse could be a nice choice.\u003C/p>\n\u003Chr>\n\u003Cp>Anyway, this is site is still WIP, hoping to see what it will eventually become.\u003C/p>",{"headings":21,"localImagePaths":29,"remoteImagePaths":30,"frontmatter":31,"imagePaths":32},[22,26],{"depth":23,"slug":24,"text":25},2,"style","#Style",{"depth":23,"slug":27,"text":28},"tech-stack","#Tech stack",[],[],{"title":14},[],"2022-06-28-new-mac",{"id":33,"data":35,"body":37,"filePath":38,"digest":39,"rendered":40},{"title":36},"What to install after getting a new Macbook","## toc\n\nApple launched back to school sale recently, so I upgraded from a Macbook Pro 13\" 2015 to a Macbook Pro 14\" 2021. Though the look is not as attractive as the old one (to me), MBP 14\" is still perfect in almost every way (to me).\n\nAnyway, I am trying to write a self-used software checklist when setting up my new laptop.\n\n## Code editors\n\n- [Visual Studio Code](https://code.visualstudio.com/)\n- [Xcode](https://developer.apple.com/xcode/) (along with [Git](https://git-scm.com/))\n\n## VS Code plugins\n\n- [One Dark Pro](https://marketplace.visualstudio.com/items?itemName=zhuangtongfa.Material-theme)\n- [Dracula](https://draculatheme.com/visual-studio-code)\n- [Python](https://marketplace.visualstudio.com/items?itemName=ms-python.python)\n- [Volar](https://marketplace.visualstudio.com/items?itemName=Vue.volar)\n- [EditorConfig](https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig)\n- [LaTeX Workshop](https://marketplace.visualstudio.com/items?itemName=James-Yu.latex-workshop)\n\n## Environments & Package managers\n\n- [Homebrew](https://brew.sh/)\n- [Miniconda](https://docs.conda.io/en/latest/miniconda.html) (`brew install --cask miniconda`)\n- [Node.js](https://nodejs.org/) (along with [npm](https://www.npmjs.com/))\n- [MacTeX](https://www.tug.org/mactex/)\n\n## Terminal\n\n- [Oh My Zsh](https://ohmyz.sh/)\n- [zsh-syntax-highlighting](https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/INSTALL.md#oh-my-zsh)\n- [zsh-autosuggestions](https://github.com/zsh-users/zsh-autosuggestions/blob/master/INSTALL.md#oh-my-zsh)\n- I've heard that [iTerm2](https://iterm2.com/) is great, but I haven't tried it yet\n\n## Browsers\n\n- [Chrome](https://www.google.com/chrome/)\n\n## Note taking\n\n- [Typora](https://typora.io/) (Markdown editor)\n- [Notion](https://www.notion.so/desktop)\n- [Bear](https://bear.app/), though it lacks some important features, the bear looks so cute!\n\n## Design\n\n- [Affinity Designer](https://affinity.serif.com/designer/)\n- [Affinity Photo](https://affinity.serif.com/photo/)\n\n## Others\n\n- [Paperlib](https://paperlib.app/en/) is a new academic paper management tool\n\n  - Pros\n\n    - It's simpler than [Zotero](https://www.zotero.org/)\n    - It's metadata scraper is tailored for computer science\n\n  - Cons\n\n    - Maintained by a single developer at the moment\n    - Bugs occur sometimes (but I'm ok with it)\n\n- Microsoft Office\n- [PDF Reader Pro](https://www.pdfreaderpro.com/)\n- [GitHub Desktop](https://desktop.github.com/)\n- [Discord](https://discord.com/)\n- [ClashX](https://github.com/yichengchen/clashX)","src/content/blog/2022-06-28-new-mac.md","b142fe51060068d6",{"html":41,"metadata":42},"\u003Cul class=\"table-of-contents\">\n\u003Cli>\u003Ca href=\"#code-editors\">Code editors\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#vs-code-plugins\">VS Code plugins\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#environments--package-managers\">Environments &#x26; Package managers\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#terminal\">Terminal\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#browsers\">Browsers\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#note-taking\">Note taking\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#design\">Design\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#others\">Others\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Cp>Apple launched back to school sale recently, so I upgraded from a Macbook Pro 13” 2015 to a Macbook Pro 14” 2021. Though the look is not as attractive as the old one (to me), MBP 14” is still perfect in almost every way (to me).\u003C/p>\n\u003Cp>Anyway, I am trying to write a self-used software checklist when setting up my new laptop.\u003C/p>\n\u003Ch2 id=\"code-editors\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#code-editors\">#\u003C/a>Code editors\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://code.visualstudio.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Visual Studio Code\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://developer.apple.com/xcode/\" rel=\"noopener noreferrer\" target=\"_blank\">Xcode\u003C/a> (along with \u003Ca href=\"https://git-scm.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Git\u003C/a>)\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"vs-code-plugins\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#vs-code-plugins\">#\u003C/a>VS Code plugins\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://marketplace.visualstudio.com/items?itemName=zhuangtongfa.Material-theme\" rel=\"noopener noreferrer\" target=\"_blank\">One Dark Pro\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://draculatheme.com/visual-studio-code\" rel=\"noopener noreferrer\" target=\"_blank\">Dracula\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://marketplace.visualstudio.com/items?itemName=ms-python.python\" rel=\"noopener noreferrer\" target=\"_blank\">Python\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://marketplace.visualstudio.com/items?itemName=Vue.volar\" rel=\"noopener noreferrer\" target=\"_blank\">Volar\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig\" rel=\"noopener noreferrer\" target=\"_blank\">EditorConfig\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://marketplace.visualstudio.com/items?itemName=James-Yu.latex-workshop\" rel=\"noopener noreferrer\" target=\"_blank\">LaTeX Workshop\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"environments--package-managers\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#environments--package-managers\">#\u003C/a>Environments &#x26; Package managers\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://brew.sh/\" rel=\"noopener noreferrer\" target=\"_blank\">Homebrew\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://docs.conda.io/en/latest/miniconda.html\" rel=\"noopener noreferrer\" target=\"_blank\">Miniconda\u003C/a> (\u003Ccode>brew install --cask miniconda\u003C/code>)\u003C/li>\n\u003Cli>\u003Ca href=\"https://nodejs.org/\" rel=\"noopener noreferrer\" target=\"_blank\">Node.js\u003C/a> (along with \u003Ca href=\"https://www.npmjs.com/\" rel=\"noopener noreferrer\" target=\"_blank\">npm\u003C/a>)\u003C/li>\n\u003Cli>\u003Ca href=\"https://www.tug.org/mactex/\" rel=\"noopener noreferrer\" target=\"_blank\">MacTeX\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"terminal\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#terminal\">#\u003C/a>Terminal\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://ohmyz.sh/\" rel=\"noopener noreferrer\" target=\"_blank\">Oh My Zsh\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/INSTALL.md#oh-my-zsh\" rel=\"noopener noreferrer\" target=\"_blank\">zsh-syntax-highlighting\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://github.com/zsh-users/zsh-autosuggestions/blob/master/INSTALL.md#oh-my-zsh\" rel=\"noopener noreferrer\" target=\"_blank\">zsh-autosuggestions\u003C/a>\u003C/li>\n\u003Cli>I’ve heard that \u003Ca href=\"https://iterm2.com/\" rel=\"noopener noreferrer\" target=\"_blank\">iTerm2\u003C/a> is great, but I haven’t tried it yet\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"browsers\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#browsers\">#\u003C/a>Browsers\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://www.google.com/chrome/\" rel=\"noopener noreferrer\" target=\"_blank\">Chrome\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"note-taking\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#note-taking\">#\u003C/a>Note taking\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://typora.io/\" rel=\"noopener noreferrer\" target=\"_blank\">Typora\u003C/a> (Markdown editor)\u003C/li>\n\u003Cli>\u003Ca href=\"https://www.notion.so/desktop\" rel=\"noopener noreferrer\" target=\"_blank\">Notion\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://bear.app/\" rel=\"noopener noreferrer\" target=\"_blank\">Bear\u003C/a>, though it lacks some important features, the bear looks so cute!\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"design\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#design\">#\u003C/a>Design\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://affinity.serif.com/designer/\" rel=\"noopener noreferrer\" target=\"_blank\">Affinity Designer\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://affinity.serif.com/photo/\" rel=\"noopener noreferrer\" target=\"_blank\">Affinity Photo\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"others\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#others\">#\u003C/a>Others\u003C/h2>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Ca href=\"https://paperlib.app/en/\" rel=\"noopener noreferrer\" target=\"_blank\">Paperlib\u003C/a> is a new academic paper management tool\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>Pros\u003C/p>\n\u003Cul>\n\u003Cli>It’s simpler than \u003Ca href=\"https://www.zotero.org/\" rel=\"noopener noreferrer\" target=\"_blank\">Zotero\u003C/a>\u003C/li>\n\u003Cli>It’s metadata scraper is tailored for computer science\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>Cons\u003C/p>\n\u003Cul>\n\u003Cli>Maintained by a single developer at the moment\u003C/li>\n\u003Cli>Bugs occur sometimes (but I’m ok with it)\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>Microsoft Office\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"https://www.pdfreaderpro.com/\" rel=\"noopener noreferrer\" target=\"_blank\">PDF Reader Pro\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"https://desktop.github.com/\" rel=\"noopener noreferrer\" target=\"_blank\">GitHub Desktop\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"https://discord.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Discord\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"https://github.com/yichengchen/clashX\" rel=\"noopener noreferrer\" target=\"_blank\">ClashX\u003C/a>\u003C/p>\n\u003C/li>\n\u003C/ul>",{"headings":43,"localImagePaths":68,"remoteImagePaths":69,"frontmatter":70,"imagePaths":71},[44,47,50,53,56,59,62,65],{"depth":23,"slug":45,"text":46},"code-editors","#Code editors",{"depth":23,"slug":48,"text":49},"vs-code-plugins","#VS Code plugins",{"depth":23,"slug":51,"text":52},"environments--package-managers","#Environments & Package managers",{"depth":23,"slug":54,"text":55},"terminal","#Terminal",{"depth":23,"slug":57,"text":58},"browsers","#Browsers",{"depth":23,"slug":60,"text":61},"note-taking","#Note taking",{"depth":23,"slug":63,"text":64},"design","#Design",{"depth":23,"slug":66,"text":67},"others","#Others",[],[],{"title":36},[],"2022-12-29-natural-gradient-decent",{"id":72,"data":74,"body":79,"filePath":80,"digest":81,"rendered":82},{"title":75,"tags":76},"Natural Gradient Decent",[77,78],"machine learning","math","## toc\n\n[中文版本](/posts/zh/2021-07-28-natural-gradient-decent)\n\nNatural gradient decent minimizes the loss function in distribution space with KL-divergence as metric, instead of the usual parameter space with Euclidean metric.\n\n## Preliminary\n\n### Gradient Decent\n\nAssume that $L(\\theta)$ is a loss function with first-order continuous partial derivatives, where $\\theta \\in R^n$. Now want to solve a unconstrained optimization problem:\n\n$$\n\\min_\\theta L(\\theta)\n$$\n\n**Gradient descent** is an iterative optimization algorithm. It works by starting at a random point on the objective function and iteratively updating $\\theta$. This process is repeated until the minimum is found or the algorithm converges. Formally, in $(k + 1)$th iteration, we have:\n\n$$\n\\theta^{(k+1)} = \\theta^{(k)} + \\eta \\vec{v} \\tag{1}\n$$\n\nwhere $\\eta$ is step size and $\\vec{v}$ is update direction. The first order Taylor series expansion of $L(\\theta^{(k+1)})$ at $\\theta^{(k)}$ is:\n\n$$\n\\begin{aligned}\n  L(\\theta^{(k+1)}) &= L(\\theta^{(k)}) + \\nabla L(\\theta^{(k)}) \\cdot (\\theta^{(k+1)} - \\theta^{(k)}) \\textcolor{blue}{+ o(\\theta^{(k)})}\\\\\n    &= L(\\theta^{(k)}) + \\eta \\vec{v} \\cdot \\nabla L(\\theta^{(k)}) \\textcolor{blue}{+ o(\\theta^{(k)})}\\\\\n    &\\approx L(\\theta^{(k)}) + \\eta \\vec{v} \\cdot \\nabla L(\\theta^{(k)})\n\\end{aligned}\n$$\n\nWe want to find a steepest descent direction around the local neighbourhood of $\\theta$ in the parameter space, that is to minimize:\n\n$$\nL(\\theta^{(k+1)}) - L(\\theta^{(k)}) = \\eta \\vec{v} \\cdot \\nabla L(\\theta^{(k)}) = \\eta  \\cdot \\| \\vec{v} \\| \\cdot \\| \\nabla L(\\theta^{(k)}) \\| \\cdot \\cos(\\alpha)\n$$\n\nwhere $\\alpha$ is the angle between $\\vec{v}$ and $\\nabla L(\\theta^{(k)})$. Obviously, when $\\alpha = - \\pi$, i.e. when $\\vec{v}$ and $\\nabla L(\\theta^{(k)})$ are in the opposite directions, $\\cos(\\alpha) = -1$ and the loss decrease most greatly. This is why gradient decent moves in the direction of the negative gradient:\n\n$$\n\\vec{v} = - \\frac{\\nabla L(\\theta^{(k)})}{\\| \\nabla L(\\theta^{(k)}) \\|}\n$$\n\nNow we can write Eq. 1 as:\n\n$$\n\\theta^{(k+1)} = \\theta^{(k)} - \\frac{\\eta}{\\| \\nabla L(\\theta^{(k)}) \\|} \\cdot \\nabla L(\\theta^{(k)})\n$$\n\nwhere $\\frac{\\eta}{\\| \\nabla L(\\theta^{(k)}) \\|}$ is learning rate.\n\n### KL Divergence\n\nThe **Kullback-Leibler divergence**, also known as the **relative entropy**, is a measure of the difference between current probability distribution $p$ and target distribution $q$, which is defined as:\n\n$$\nKL (p \\| q) = \\int p(x) \\log \\frac{p(x)}{q(x)} dx\n$$\n\nThe KL divergence is zero if and only if the two distributions are equal. Note that KL divergence is non-symmetric, meaning that the KL divergence between $p$ and $q$ is not necessarily equal to that between $q$ and $p$.\n\n### Fisher Information Matrix\n\nI suggest having a look at this [great article](https://agustinus.kristia.de/techblog/2018/03/11/fisher-information/). To be short, the **Fisher Information Matrix** is:\n\n- the second moment of the first-order derivative of the log-likelihood function:\n\n  $$\n  F = \\mathbb{E}_{p(x \\mid \\theta)} \\Big [ \\nabla \\log p(x \\mid \\theta) \\nabla \\log p(x \\mid \\theta)^T \\Big ]\n  $$\n\n- the negative expectation of the Hessian matrix of the log-likelihood function ([proof](https://agustinus.kristia.de/techblog/2018/03/11/fisher-information/)):\n\n  $$\n  F = - \\mathbb{E}_{p(x \\mid \\theta)} \\left [ \\frac{\\partial^2}{\\partial_{\\theta} \\partial_{\\theta^T}} \\log p(x \\mid \\theta) \\right ]\n  $$\n\n### KL Divergence & Fisher Information\n\nLet $d \\to 0$, we have:\n\n$$\nKL \\Big ( p(x \\mid \\theta) \\| p(x \\mid \\theta + d) \\Big ) \\approx \\frac{1}{2} d^T F d\n$$\n\n:::details[Proof]\nFor convenience, we denote $p(x \\mid \\theta)$ and $p(x \\mid \\theta + d)$ as $p(\\theta)$ and $p(\\theta + d)$, respectively.\n\n$$\n\\begin{aligned}\n  KL \\Big ( p(\\theta) \\| p(\\theta + d) \\Big ) &= \\int p(\\theta) \\log \\frac{p(\\theta)}{p(\\theta + d)} dx = \\mathbb{E}_{p(\\theta)} \\left [ \\log \\frac{p(\\theta)}{p(\\theta + d)} \\right ] \\\\\n    &= \\mathbb{E}_{p(\\theta)} [ \\log p(\\theta) ] - \\textcolor{blue}{\\mathbb{E}_{p(\\theta)} [ \\log p(\\theta + d) ]}  \\\\\n    &\\approx \\mathbb{E}_{p(\\theta)} [ \\log p(\\theta) ] - \\textcolor{blue}{\\underbrace{\\mathbb{E}_{p(\\theta)} \\left [ \\log p(\\theta) + \\nabla \\log p(\\theta) d + \\frac{1}{2} d^T \\nabla^2 \\log p(\\theta) d \\right ]}_{\\text{second order Taylor expansion}}}  \\\\\n    & = - \\mathbb{E}_{p(\\theta)} [ \\nabla \\log p(\\theta) d ] - \\mathbb{E}_{p(\\theta)} \\left [ \\frac{1}{2} d^T \\nabla^2 \\log p(\\theta) d \\right ] \\\\\n    &= - \\left [ \\int_{\\theta} p(\\theta) \\frac{1}{p(\\theta)} \\nabla p(\\theta) d \\theta \\right ] d - \\frac{1}{2} d^T \\mathbb{E}_{p(\\theta)} [ \\nabla^2 \\log p(\\theta) ] d \\\\\n    &= - \\left [ \\nabla \\int_{\\theta}  p(\\theta) d \\theta \\right ] d - \\frac{1}{2} d^T \\mathbb{E}_{p(\\theta)} [ \\nabla^2 \\log p(\\theta) ] d \\\\\n    & = - \\frac{1}{2} d^T \\underbrace{\\mathbb{E}_{p(\\theta)} [ \\nabla^2 \\log p(\\theta) ]}_{= - F} d \\\\\n    & = \\frac{1}{2} d^T F d\n\\end{aligned}\n$$\n\n:::\n\nWhich means the Fisher Information Matrix $F$ defines the local curvature in distribution space for which KL-divergence is the metric.\n\n### Riemannian manifold\n\n#### Manifold\n\nA manifold is a topological space sharing the local properties of Euclidean spaces. Every point on a manifold has a small neighborhood around it that can be locally approximated by a tangent plane, which means that the curvature of this neighborhood is approximately zero. This allows us to use the Euclidean metric, which is based on the properties of flat space, to measure distance within this small neighborhood. To help your understanding, people on earth may experience their surroundings as being flat, but they are unable to perceive the curvature of the earth due to its large size.\n\nMore formally: A manifold $M$ of dimension $n$ is a topological space, such that every point $x \\in M$ has a neighbourhood which is homeomorphic to an open set in Euclidean space $\\Reals^n$. This open set in Euclidean space is called **tangent space**, refered as $T_x M$.\n\n#### Riemannian Metric\n\nThe distance between two points in an Euclidean space can be easily determined by taking the modulusof the vector connecting the points. However, manifolds are not linear spaces, so we need to use alternative methods to calculate lengths on a manifold. One possible approach is to consider a continuous, differentiable curve, represented by $\\gamma: [a, b] \\to M$, on the manifold and compute the integral of the distance differential at each point along curve $\\gamma$:\n\n$$\nL(\\gamma) = \\int_a^b \\| \\gamma'(x) \\| dx\n$$\n\nThus for each point $\\gamma(x)$, we have to define a notion of distance in the tangent space at that point. We then use the notion to calculate the modulus $\\| \\gamma'(x) \\|$ of the tangent vector $\\gamma'(x) = \\frac{\\partial}{\\partial x} \\gamma(x)$ at the point and add up all of $\\| \\gamma'(x) \\|$ to obtain the total length of the curve.\n\nTo calculate $\\| \\gamma'(x) \\|$:\n\n$$\n\\| \\gamma'(x) \\|^2 = ⟨ \\gamma'(x), \\gamma'(x) ⟩ = g_{\\gamma(x)} (\\gamma'(x), \\gamma'(x))\n$$\n\nThe square of the modulus of a vector, also known as the Euclidean norm or the $\\ell_2$ norm, is equal to the inner product of the vector with itself. This means that $g_x: T_x M \\times T_x M \\to \\Reals$ defines a **metric**, which is a way of measuring distance, over a tangent space. A metric that varies smoothly with respect to a point on a manifold is known as a **Riemannian metric**, and a manifold equipped with a Riemannian metric is called a **Riemannian manifold**.\n\nAs explained [here](https://www.math.fsu.edu/~whuang2/pdf/ECNU_slides.pdf) (page 4):\n\n> Roughly, a Riemannian manifold $M$ is a smooth set with a smoothly-varying inner product on the tangent spaces.\n\nFormally, for each $x \\in M$，a Riemannian metric $g = g_x$ satisfies:\n\n- $g(u, v) = g(v, u)$ for all $u, v \\in T_x M$\n- $g(u, u) \\geq 0$ for all $u \\in T_x M$\n- $g(u, u) = 0$ if and only if $u = 0$\n\n## Natural Gradient Decent\n\n### Constrained Optimization\n\nLet's start with looking at **natural gradient decent** from aspect of constrained optimization. In traditional gradient decent, the constrained optimization problem we want to solve is:\n\n$$\n\\begin{gathered}\n  \\min_{d} L(\\theta + d) \\\\\n  \\text{s.t.} \\enspace \\| d \\| \\leq \\epsilon\n\\end{gathered}\n$$\n\nwhere the distance in parameter space is contrained and can be calculated using Euclidean metric.\n\nAs mentioned [before](#gradient-decent), the steepest descent direction is the direction of the negative gradient:\n\n$$\n- \\frac{\\nabla L(\\theta)}{\\| \\nabla L(\\theta) \\|} = \\lim_{\\epsilon \\to 0} \\frac{1}{\\epsilon} \\arg \\min_{d \\text{ s.t.} \\| d \\| \\leq \\epsilon} L(\\theta + d)\n$$\n\nWhen using gradient descent, the distribution of the parameters may change as the optimization process progresses. However, it is also important to ensure that the amount of change in the distribution is controlled, as large changes can lead to instability in the model. The Euclidean distance, which is based on the properties of flat space, may not be an appropriate measure of the amount of change in the distribution. Therefore, natural gradient decent works in **distribution space** and uses KL divergence to compare the current distribution of parameters $p(x \\mid \\theta)$ with the target distribution $p(x \\mid \\theta + d)$. Now the constraint becomes:\n\n$$\n\\text{s.t.} \\enspace KL \\Big ( p(x \\mid \\theta) \\| p(x \\mid \\theta + d) \\Big ) \\leq \\epsilon\n$$\n\nWe apply the Lagrange multiplier method to it:\n\n$$\n\\begin{aligned}\n  d^* &= \\arg \\min_{d} L(\\theta + d) + \\lambda \\Big ( KL \\big ( p(x | \\theta) \\| p(x | \\theta + d) \\big ) - \\epsilon \\Big )  \\\\\n    &\\approx \\arg \\min_{d} \\underbrace{L(\\theta) + \\nabla L(\\theta)^T d}_{\\text{first order Taylor expansion}} + \\underbrace{\\frac{1}{2} \\lambda d^T F d}_{\\text{second order Taylor expansion}} - \\lambda \\epsilon\n\\end{aligned}\n$$\n\nTo solve this minimization, we set its derivative to zero:\n\n$$\n\\begin{aligned}\n  0 &= \\frac{\\partial}{\\partial d} \\left [ L(\\theta) + \\nabla L(\\theta)^T d + \\frac{1}{2} \\lambda d^T F d  - \\lambda \\epsilon \\right ] \\\\\n    &= \\nabla L(\\theta) + \\lambda F d \\\\\n  \\lambda F d &= -\\nabla L(\\theta) \\\\\n  d &= - \\frac{1}{\\lambda} F^{-1} \\nabla L(\\theta)\n\\end{aligned}\n$$\n\nFinally, the optimal descent direction is $\\tilde{\\nabla} L(\\theta) = F^{-1} \\nabla L(\\theta)$ (constant factor can be absorbed into the learning rate), called **natural gradient**.\n\n### Riemannian Manifold\n\nNow we consider optimizing the objective function on a manifold. We can easily recognize that the descent direction depends on how to calculate $\\|d\\|$, i.e., what's the metric on the manifold.\n\nThe tranditional gradient decent works on parameter space (a Euclidean space), of which the metric is Euclidean metric. The natural gradient descent operates in distribution space (a Riemannian manifold), in which a point, represented by $p(x \\mid \\theta)$, can be thought of as a parameterized probability distribution. When the parameter $\\theta$ changes to $\\theta + d$, the distance between $p(x \\mid \\theta)$ and $p(x \\mid \\theta + d)$ is $\\frac{1}{2} d^T F d$. It can be seen that the Fisher information matrix $F$ serves as the Riemannian metric on this Riemannian manifold.\n\nThe Fisher information matrix reflects the local curvature of the likelihood probability distribution space, which means that it encodes information about how much the probability distribution changes as the parameters vary. By using the Fisher information matrix as a measure, we can obtain the descent direction that takes into account the curvature of the probability distribution space. This is important because the larger the curvature, the smaller the range of parameter values that can be used to maintain a given likelihood. Natural gradient descent ensures that the optimization process respects the underlying geometry of the probability distribution space and avoids making large, unstable changes to the parameters.\n\n## References\n\n- [Natural Gradient Descent](https://agustinus.kristia.de/techblog/2018/03/14/natural-gradient/). _Agustinus Kristiadi_.\n- [Differential Geometry](https://maths-people.anu.edu.au/~andrews/DG/). _Ben Andrews_. Australian National University.\n- [Differential Geometry](http://people.maths.ox.ac.uk/~joyce/Nairobi2019/Hitchin-DifferentiableManifolds.pdf). _Nigel Hitchin_. Oxford University.\n- [Riemannian Metrics](https://www.ime.usp.br/~gorodski/teaching/mat5771/ch1.pdf). _Claudio Gorodski_. University of São Paulo.\n- [Geometric Deep Learning: Going beyond Euclidean Data](https://arxiv.org/abs/1611.08097). IEEE Signal Processing Magazine 2017. _Michael M. Bronstein, et al_.","src/content/blog/2022-12-29-natural-gradient-decent.md","6abcaf895e846428",{"html":83,"metadata":84},"\u003Cul class=\"table-of-contents\">\n\u003Cli>\n\u003Cp>\u003Ca href=\"#preliminary\">Preliminary\u003C/a>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ca href=\"#gradient-decent\">Gradient Decent\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#kl-divergence\">KL Divergence\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#fisher-information-matrix\">Fisher Information Matrix\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#kl-divergence--fisher-information\">KL Divergence &#x26; Fisher Information\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#riemannian-manifold\">Riemannian manifold\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#natural-gradient-decent\">Natural Gradient Decent\u003C/a>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ca href=\"#constrained-optimization\">Constrained Optimization\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#riemannian-manifold-1\">Riemannian Manifold\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#references\">References\u003C/a>\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Ca href=\"/posts/zh/2021-07-28-natural-gradient-decent\">中文版本\u003C/a>\u003C/p>\n\u003Cp>Natural gradient decent minimizes the loss function in distribution space with KL-divergence as metric, instead of the usual parameter space with Euclidean metric.\u003C/p>\n\u003Ch2 id=\"preliminary\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#preliminary\">#\u003C/a>Preliminary\u003C/h2>\n\u003Ch3 id=\"gradient-decent\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#gradient-decent\">#\u003C/a>Gradient Decent\u003C/h3>\n\u003Cp>Assume that \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">L(\\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> is a loss function with first-order continuous partial derivatives, where \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>θ\u003C/mi>\u003Cmo>∈\u003C/mo>\u003Cmsup>\u003Cmi>R\u003C/mi>\u003Cmi>n\u003C/mi>\u003C/msup>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\theta \\in R^n\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6644em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">n\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>. Now want to solve a unconstrained optimization problem:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmunder>\u003Cmrow>\u003Cmi>min\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003C/mrow>\u003Cmi>θ\u003C/mi>\u003C/munder>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\min_\\theta L(\\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.5021em;vertical-align:-0.7521em;\">\u003C/span>\u003Cspan class=\"mop op-limits\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6679em;\">\u003Cspan style=\"top:-2.3479em;margin-left:0em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan>\u003Cspan class=\"mop\">min\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7521em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>\u003Cstrong>Gradient descent\u003C/strong> is an iterative optimization algorithm. It works by starting at a random point on the objective function and iteratively updating \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>θ\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\theta\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003C/span>\u003C/span>\u003C/span>. This process is repeated until the minimum is found or the algorithm converges. Formally, in \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">(k + 1)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">1\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>th iteration, we have:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmtable width=\"100%\">\u003Cmtr>\u003Cmtd width=\"50%\">\u003C/mtd>\u003Cmtd>\u003Cmrow>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo>=\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo>+\u003C/mo>\u003Cmi>η\u003C/mi>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003C/mrow>\u003C/mtd>\u003Cmtd width=\"50%\">\u003C/mtd>\u003Cmtd>\u003Cmtext>(1)\u003C/mtext>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cannotation encoding=\"application/x-tex\">\\theta^{(k+1)} = \\theta^{(k)} + \\eta \\vec{v} \\tag{1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.938em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0213em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.9084em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"tag\">\u003Cspan class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord text\">\u003Cspan class=\"mord\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003Cspan class=\"mord\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>where \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>η\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\eta\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003C/span>\u003C/span>\u003C/span> is step size and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\vec{v}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.714em;\">\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> is update direction. The first order Taylor series expansion of \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">L(\\theta^{(k+1)})\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.888em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> at \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\theta^{(k)}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.888em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.888em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> is:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>⋅\u003C/mo>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo>−\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmstyle mathcolor=\"blue\">\u003Cmo>+\u003C/mo>\u003Cmi>o\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mstyle>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi>η\u003C/mi>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003Cmo>⋅\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmstyle mathcolor=\"blue\">\u003Cmo>+\u003C/mo>\u003Cmi>o\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mstyle>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>≈\u003C/mo>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi>η\u003C/mi>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003Cmo>⋅\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cannotation encoding=\"application/x-tex\">\\begin{aligned}\n  L(\\theta^{(k+1)}) &#x26;= L(\\theta^{(k)}) + \\nabla L(\\theta^{(k)}) \\cdot (\\theta^{(k+1)} - \\theta^{(k)}) \\textcolor{blue}{+ o(\\theta^{(k)})}\\\\\n    &#x26;= L(\\theta^{(k)}) + \\eta \\vec{v} \\cdot \\nabla L(\\theta^{(k)}) \\textcolor{blue}{+ o(\\theta^{(k)})}\\\\\n    &#x26;\\approx L(\\theta^{(k)}) + \\eta \\vec{v} \\cdot \\nabla L(\\theta^{(k)})\n\\end{aligned}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:4.794em;vertical-align:-2.147em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-r\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.647em;\">\u003Cspan style=\"top:-4.709em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.111em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.513em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.147em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"col-align-l\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.647em;\">\u003Cspan style=\"top:-4.709em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\" style=\"color:blue;\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">o\u003C/span>\u003Cspan class=\"mopen\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mtight\" style=\"color:blue;\">\u003Cspan class=\"mopen mtight\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;color:blue;\">k\u003C/span>\u003Cspan class=\"mclose mtight\" style=\"color:blue;\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\" style=\"color:blue;\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.111em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\" style=\"color:blue;\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">o\u003C/span>\u003Cspan class=\"mopen\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mtight\" style=\"color:blue;\">\u003Cspan class=\"mopen mtight\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;color:blue;\">k\u003C/span>\u003Cspan class=\"mclose mtight\" style=\"color:blue;\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\" style=\"color:blue;\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.513em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">≈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.147em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>We want to find a steepest descent direction around the local neighbourhood of \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>θ\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\theta\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003C/span>\u003C/span>\u003C/span> in the parameter space, that is to minimize:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmi>η\u003C/mi>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003Cmo>⋅\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmi>η\u003C/mi>\u003Cmo>⋅\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmo>⋅\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmo>⋅\u003C/mo>\u003Cmi>cos\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>α\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">L(\\theta^{(k+1)}) - L(\\theta^{(k)}) = \\eta \\vec{v} \\cdot \\nabla L(\\theta^{(k)}) = \\eta  \\cdot \\| \\vec{v} \\| \\cdot \\| \\nabla L(\\theta^{(k)}) \\| \\cdot \\cos(\\alpha)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.9084em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∥∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mop\">cos\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>where \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>α\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\alpha\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.4306em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α\u003C/span>\u003C/span>\u003C/span>\u003C/span> is the angle between \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\vec{v}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.714em;\">\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\nabla L(\\theta^{(k)})\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.888em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>. Obviously, when \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>α\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmi>π\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\alpha = - \\pi\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.4306em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π\u003C/span>\u003C/span>\u003C/span>\u003C/span>, i.e. when \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\vec{v}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.714em;\">\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\nabla L(\\theta^{(k)})\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.888em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> are in the opposite directions, \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>cos\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>α\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\cos(\\alpha) = -1\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mop\">cos\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span> and the loss decrease most greatly. This is why gradient decent moves in the direction of the negative gradient:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmover accent=\"true\">\u003Cmi>v\u003C/mi>\u003Cmo>⃗\u003C/mo>\u003C/mover>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmfrac>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003C/mfrac>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\vec{v} = - \\frac{\\nabla L(\\theta^{(k)})}{\\| \\nabla L(\\theta^{(k)}) \\|}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.714em;\">\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.714em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.2077em;\">\u003Cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\">\u003Cpath d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.519em;vertical-align:-0.954em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.565em;\">\u003Cspan style=\"top:-2.296em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∥∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.814em;\">\u003Cspan style=\"top:-2.989em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.888em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.954em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>Now we can write Eq. 1 as:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo>=\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo>−\u003C/mo>\u003Cmfrac>\u003Cmi>η\u003C/mi>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003C/mfrac>\u003Cmo>⋅\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\theta^{(k+1)} = \\theta^{(k)} - \\frac{\\eta}{\\| \\nabla L(\\theta^{(k)}) \\|} \\cdot \\nabla L(\\theta^{(k)})\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.938em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0213em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.0616em;vertical-align:-0.954em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.1076em;\">\u003Cspan style=\"top:-2.296em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∥∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.814em;\">\u003Cspan style=\"top:-2.989em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.954em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">⋅\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.188em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.938em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>where \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmfrac>\u003Cmi>η\u003C/mi>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>k\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003C/mfrac>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\frac{\\eta}{\\| \\nabla L(\\theta^{(k)}) \\|}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.3079em;vertical-align:-0.5604em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7475em;\">\u003Cspan style=\"top:-2.6146em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">∥∇\u003C/span>\u003Cspan class=\"mord mathnormal mtight\">L\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.822em;\">\u003Cspan style=\"top:-2.822em;margin-right:0.0714em;\">\u003Cspan class=\"pstrut\" style=\"height:2.5357em;\">\u003C/span>\u003Cspan class=\"sizing reset-size3 size1 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003Cspan class=\"mord mtight\">∥\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.4461em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">η\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.5604em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> is learning rate.\u003C/p>\n\u003Ch3 id=\"kl-divergence\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#kl-divergence\">#\u003C/a>KL Divergence\u003C/h3>\n\u003Cp>The \u003Cstrong>Kullback-Leibler divergence\u003C/strong>, also known as the \u003Cstrong>relative entropy\u003C/strong>, is a measure of the difference between current probability distribution \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003C/span>\u003C/span>\u003C/span> and target distribution \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>q\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">q\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q\u003C/span>\u003C/span>\u003C/span>\u003C/span>, which is defined as:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>K\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>q\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmo>∫\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmfrac>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmi>q\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mfrac>\u003Cmi>d\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">KL (p \\| q) = \\int p(x) \\log \\frac{p(x)}{q(x)} dx\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\">\u003C/span>\u003Cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.427em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.936em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>The KL divergence is zero if and only if the two distributions are equal. Note that KL divergence is non-symmetric, meaning that the KL divergence between \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>q\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">q\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q\u003C/span>\u003C/span>\u003C/span>\u003C/span> is not necessarily equal to that between \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>q\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">q\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003C/span>\u003C/span>\u003C/span>.\u003C/p>\n\u003Ch3 id=\"fisher-information-matrix\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#fisher-information-matrix\">#\u003C/a>Fisher Information Matrix\u003C/h3>\n\u003Cp>I suggest having a look at this \u003Ca href=\"https://agustinus.kristia.de/techblog/2018/03/11/fisher-information/\" rel=\"noopener noreferrer\" target=\"_blank\">great article\u003C/a>. To be short, the \u003Cstrong>Fisher Information Matrix\u003C/strong> is:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>the second moment of the first-order derivative of the log-likelihood function:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">[\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmsup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">]\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F = \\mathbb{E}_{p(x \\mid \\theta)} \\Big [ \\nabla \\log p(x \\mid \\theta) \\nabla \\log p(x \\mid \\theta)^T \\Big ]\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003Cspan class=\"mrel mtight\">∣\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">[\u003C/span>\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">]\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003C/li>\n\u003Cli>\n\u003Cp>the negative expectation of the Hessian matrix of the log-likelihood function (\u003Ca href=\"https://agustinus.kristia.de/techblog/2018/03/11/fisher-information/\" rel=\"noopener noreferrer\" target=\"_blank\">proof\u003C/a>):\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmfrac>\u003Cmsup>\u003Cmi mathvariant=\"normal\">∂\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msup>\u003Cmrow>\u003Cmsub>\u003Cmi mathvariant=\"normal\">∂\u003C/mi>\u003Cmi>θ\u003C/mi>\u003C/msub>\u003Cmsub>\u003Cmi mathvariant=\"normal\">∂\u003C/mi>\u003Cmsup>\u003Cmi>θ\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003C/msub>\u003C/mrow>\u003C/mfrac>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F = - \\mathbb{E}_{p(x \\mid \\theta)} \\left [ \\frac{\\partial^2}{\\partial_{\\theta} \\partial_{\\theta^T}} \\log p(x \\mid \\theta) \\right ]\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.4411em;vertical-align:-0.95em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003Cspan class=\"mrel mtight\">∣\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">[\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.4911em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\" style=\"margin-right:0.05556em;\">∂\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3361em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\" style=\"margin-right:0.05556em;\">∂\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5029em;margin-left:-0.0556em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7741em;\">\u003Cspan style=\"top:-2.786em;margin-right:0.0714em;\">\u003Cspan class=\"pstrut\" style=\"height:2.5em;\">\u003C/span>\u003Cspan class=\"sizing reset-size3 size1 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1971em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\" style=\"margin-right:0.05556em;\">∂\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8831em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mclose delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">]\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"kl-divergence--fisher-information\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#kl-divergence--fisher-information\">#\u003C/a>KL Divergence &#x26; Fisher Information\u003C/h3>\n\u003Cp>Let \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>d\u003C/mi>\u003Cmo>→\u003C/mo>\u003Cmn>0\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">d \\to 0\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">→\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span>, we have:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>K\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">(\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">)\u003C/mo>\u003Cmo>≈\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>F\u003C/mi>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">KL \\Big ( p(x \\mid \\theta) \\| p(x \\mid \\theta + d) \\Big ) \\approx \\frac{1}{2} d^T F d\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">(\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">)\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">≈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cdetails class=\"custom-block details\">\u003Csummary class=\"custom-block-title\">Proof\u003C/summary>\u003Cp>For convenience, we denote \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(x \\mid \\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(x \\mid \\theta + d)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> as \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(\\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(\\theta + d)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>, respectively.\u003C/p>\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmi>K\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">(\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">)\u003C/mo>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmo>∫\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmfrac>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mfrac>\u003Cmi>d\u003C/mi>\u003Cmi>x\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmfrac>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mfrac>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmstyle mathcolor=\"blue\">\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003C/mstyle>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>≈\u003C/mo>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmstyle mathcolor=\"blue\">\u003Cmunder>\u003Cmunder>\u003Cmrow>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmsup>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msup>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003C/mrow>\u003Cmo stretchy=\"true\">⏟\u003C/mo>\u003C/munder>\u003Cmtext>second order Taylor expansion\u003C/mtext>\u003C/munder>\u003C/mstyle>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmsup>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msup>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmsub>\u003Cmo>∫\u003C/mo>\u003Cmi>θ\u003C/mi>\u003C/msub>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mfrac>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmi>θ\u003C/mi>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003Cmi>d\u003C/mi>\u003Cmo>−\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmsup>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msup>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmsub>\u003Cmo>∫\u003C/mo>\u003Cmi>θ\u003C/mi>\u003C/msub>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmi>θ\u003C/mi>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003Cmi>d\u003C/mi>\u003Cmo>−\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmsup>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msup>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmunder>\u003Cmunder>\u003Cmrow>\u003Cmsub>\u003Cmi mathvariant=\"double-struck\">E\u003C/mi>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmsup>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msup>\u003Cmi>log\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003C/mrow>\u003Cmo stretchy=\"true\">⏟\u003C/mo>\u003C/munder>\u003Cmrow>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003C/munder>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>F\u003C/mi>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cannotation encoding=\"application/x-tex\">\\begin{aligned}\n  KL \\Big ( p(\\theta) \\| p(\\theta + d) \\Big ) &#x26;= \\int p(\\theta) \\log \\frac{p(\\theta)}{p(\\theta + d)} dx = \\mathbb{E}_{p(\\theta)} \\left [ \\log \\frac{p(\\theta)}{p(\\theta + d)} \\right ] \\\\\n    &#x26;= \\mathbb{E}_{p(\\theta)} [ \\log p(\\theta) ] - \\textcolor{blue}{\\mathbb{E}_{p(\\theta)} [ \\log p(\\theta + d) ]}  \\\\\n    &#x26;\\approx \\mathbb{E}_{p(\\theta)} [ \\log p(\\theta) ] - \\textcolor{blue}{\\underbrace{\\mathbb{E}_{p(\\theta)} \\left [ \\log p(\\theta) + \\nabla \\log p(\\theta) d + \\frac{1}{2} d^T \\nabla^2 \\log p(\\theta) d \\right ]}_{\\text{second order Taylor expansion}}}  \\\\\n    &#x26; = - \\mathbb{E}_{p(\\theta)} [ \\nabla \\log p(\\theta) d ] - \\mathbb{E}_{p(\\theta)} \\left [ \\frac{1}{2} d^T \\nabla^2 \\log p(\\theta) d \\right ] \\\\\n    &#x26;= - \\left [ \\int_{\\theta} p(\\theta) \\frac{1}{p(\\theta)} \\nabla p(\\theta) d \\theta \\right ] d - \\frac{1}{2} d^T \\mathbb{E}_{p(\\theta)} [ \\nabla^2 \\log p(\\theta) ] d \\\\\n    &#x26;= - \\left [ \\nabla \\int_{\\theta}  p(\\theta) d \\theta \\right ] d - \\frac{1}{2} d^T \\mathbb{E}_{p(\\theta)} [ \\nabla^2 \\log p(\\theta) ] d \\\\\n    &#x26; = - \\frac{1}{2} d^T \\underbrace{\\mathbb{E}_{p(\\theta)} [ \\nabla^2 \\log p(\\theta) ]}_{= - F} d \\\\\n    &#x26; = \\frac{1}{2} d^T F d\n\\end{aligned}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:22.1391em;vertical-align:-10.8196em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-r\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:11.3196em;\">\u003Cspan style=\"top:-13.3196em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">(\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-11.2295em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-9.1195em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-4.9493em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.2492em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:0.4508em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:3.0223em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:6.3836em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:10.8196em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"col-align-l\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:11.3196em;\">\u003Cspan style=\"top:-13.3196em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.427em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.936em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">[\u003C/span>\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.427em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.936em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mclose delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">]\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-11.2295em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">[\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)]\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord mathbb\" style=\"color:blue;\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mathnormal mtight\" style=\"color:blue;\">p\u003C/span>\u003Cspan class=\"mopen mtight\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\" style=\"color:blue;\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\" style=\"color:blue;\">[\u003C/span>\u003Cspan class=\"mop\" style=\"color:blue;\">\u003Cspan style=\"color:blue;\">l\u003C/span>\u003Cspan style=\"color:blue;\">o\u003C/span>\u003Cspan style=\"margin-right:0.01389em;color:blue;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">p\u003C/span>\u003Cspan class=\"mopen\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\" style=\"color:blue;\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">d\u003C/span>\u003Cspan class=\"mclose\" style=\"color:blue;\">)]\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-9.1195em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">≈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">[\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)]\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord munder\" style=\"color:blue;\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.45em;\">\u003Cspan style=\"top:-1.1659em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mtight\" style=\"color:blue;\">\u003Cspan class=\"mord text mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mtight\" style=\"color:blue;\">second order Taylor expansion\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.45em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord munder\" style=\"color:blue;\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.45em;\">\u003Cspan class=\"svg-align\" style=\"top:-1.852em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"stretchy\" style=\"color:blue;height:0.548em;min-width:1.6em;\">\u003Cspan class=\"brace-left\" style=\"color:blue;height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMinYMin slice\">\u003Cpath d=\"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-center\" style=\"color:blue;height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMidYMin slice\">\u003Cpath d=\"M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-right\" style=\"color:blue;height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMaxYMin slice\">\u003Cpath d=\"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.45em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord mathbb\" style=\"color:blue;\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mathnormal mtight\" style=\"color:blue;\">p\u003C/span>\u003Cspan class=\"mopen mtight\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\" style=\"color:blue;\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\" style=\"color:blue;\">\u003Cspan class=\"mopen delimcenter\" style=\"color:blue;top:0em;\">\u003Cspan class=\"delimsizing size3\" style=\"color:blue;\">\u003Cspan style=\"color:blue;\">[\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mop\" style=\"color:blue;\">\u003Cspan style=\"color:blue;\">l\u003C/span>\u003Cspan style=\"color:blue;\">o\u003C/span>\u003Cspan style=\"margin-right:0.01389em;color:blue;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">p\u003C/span>\u003Cspan class=\"mopen\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"mclose\" style=\"color:blue;\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\" style=\"color:blue;\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">∇\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\" style=\"color:blue;\">\u003Cspan style=\"color:blue;\">l\u003C/span>\u003Cspan style=\"color:blue;\">o\u003C/span>\u003Cspan style=\"margin-right:0.01389em;color:blue;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">p\u003C/span>\u003Cspan class=\"mopen\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"mclose\" style=\"color:blue;\">)\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">d\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\" style=\"color:blue;\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord\" style=\"color:blue;\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"color:blue;border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord\" style=\"color:blue;\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;color:blue;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\" style=\"color:blue;\">\u003Cspan class=\"mord\" style=\"color:blue;\">∇\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\" style=\"color:blue;\">\u003Cspan class=\"mord mtight\" style=\"color:blue;\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\" style=\"color:blue;\">\u003Cspan style=\"color:blue;\">l\u003C/span>\u003Cspan style=\"color:blue;\">o\u003C/span>\u003Cspan style=\"margin-right:0.01389em;color:blue;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"color:blue;margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">p\u003C/span>\u003Cspan class=\"mopen\" style=\"color:blue;\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;color:blue;\">θ\u003C/span>\u003Cspan class=\"mclose\" style=\"color:blue;\">)\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"color:blue;\">d\u003C/span>\u003Cspan class=\"mclose delimcenter\" style=\"color:blue;top:0em;\">\u003Cspan class=\"delimsizing size3\" style=\"color:blue;\">\u003Cspan style=\"color:blue;\">]\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.598em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.4202em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-4.9493em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">[\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">]\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">[\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">]\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.2492em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">[\u003C/span>\u003C/span>\u003Cspan class=\"mop\">\u003Cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:-0.4258em;\">\u003Cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.9119em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.936em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">]\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">[\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)]\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:0.4508em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">[\u003C/span>\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">\u003Cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:-0.4258em;\">\u003Cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.9119em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">]\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">[\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)]\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:3.0223em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord munder\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-1.3185em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mrel mtight\">=\u003C/span>\u003Cspan class=\"mord mtight\">−\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord munder\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan class=\"svg-align\" style=\"top:-1.9968em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\">\u003Cspan class=\"brace-left\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMinYMin slice\">\u003Cpath d=\"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-center\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMidYMin slice\">\u003Cpath d=\"M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-right\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMaxYMin slice\">\u003Cpath d=\"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">E\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">p\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">[\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">lo\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)]\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.0032em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.7399em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:6.3836em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:10.8196em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/details>\n\u003Cp>Which means the Fisher Information Matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span> defines the local curvature in distribution space for which KL-divergence is the metric.\u003C/p>\n\u003Ch3 id=\"riemannian-manifold\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#riemannian-manifold\">#\u003C/a>Riemannian manifold\u003C/h3>\n\u003Ch4 id=\"manifold\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#manifold\">#\u003C/a>Manifold\u003C/h4>\n\u003Cp>A manifold is a topological space sharing the local properties of Euclidean spaces. Every point on a manifold has a small neighborhood around it that can be locally approximated by a tangent plane, which means that the curvature of this neighborhood is approximately zero. This allows us to use the Euclidean metric, which is based on the properties of flat space, to measure distance within this small neighborhood. To help your understanding, people on earth may experience their surroundings as being flat, but they are unable to perceive the curvature of the earth due to its large size.\u003C/p>\n\u003Cp>More formally: A manifold \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span> of dimension \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>n\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">n\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.4306em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">n\u003C/span>\u003C/span>\u003C/span>\u003C/span> is a topological space, such that every point \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>x\u003C/mi>\u003Cmo>∈\u003C/mo>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">x \\in M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span> has a neighbourhood which is homeomorphic to an open set in Euclidean space \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsup>\u003Cmi mathvariant=\"double-struck\">R\u003C/mi>\u003Cmi>n\u003C/mi>\u003C/msup>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\Reals^n\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6889em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathbb\">R\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6644em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">n\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>. This open set in Euclidean space is called \u003Cstrong>tangent space\u003C/strong>, refered as \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>T\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/msub>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">T_x M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1514em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span>.\u003C/p>\n\u003Ch4 id=\"riemannian-metric\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#riemannian-metric\">#\u003C/a>Riemannian Metric\u003C/h4>\n\u003Cp>The distance between two points in an Euclidean space can be easily determined by taking the modulusof the vector connecting the points. However, manifolds are not linear spaces, so we need to use alternative methods to calculate lengths on a manifold. One possible approach is to consider a continuous, differentiable curve, represented by \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>γ\u003C/mi>\u003Cmo>:\u003C/mo>\u003Cmo stretchy=\"false\">[\u003C/mo>\u003Cmi>a\u003C/mi>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmi>b\u003C/mi>\u003Cmo stretchy=\"false\">]\u003C/mo>\u003Cmo>→\u003C/mo>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\gamma: [a, b] \\to M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">:\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">[\u003C/span>\u003Cspan class=\"mord mathnormal\">a\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">b\u003C/span>\u003Cspan class=\"mclose\">]\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">→\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span>, on the manifold and compute the integral of the distance differential at each point along curve \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>γ\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\gamma\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003C/span>\u003C/span>\u003C/span>:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>γ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmsubsup>\u003Cmo>∫\u003C/mo>\u003Cmi>a\u003C/mi>\u003Cmi>b\u003C/mi>\u003C/msubsup>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">L(\\gamma) = \\int_a^b \\| \\gamma'(x) \\| dx\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.511em;vertical-align:-0.9119em;\">\u003C/span>\u003Cspan class=\"mop\">\u003Cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.599em;\">\u003Cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">a\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.8129em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">b\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.9119em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8019em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>Thus for each point \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>γ\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\gamma(x)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>, we have to define a notion of distance in the tangent space at that point. We then use the notion to calculate the modulus \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\| \\gamma'(x) \\|\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7519em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003C/span>\u003C/span>\u003C/span> of the tangent vector \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmfrac>\u003Cmi mathvariant=\"normal\">∂\u003C/mi>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∂\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/mrow>\u003C/mfrac>\u003Cmi>γ\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\gamma'(x) = \\frac{\\partial}{\\partial x} \\gamma(x)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7519em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.2251em;vertical-align:-0.345em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8801em;\">\u003Cspan style=\"top:-2.655em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂\u003C/span>\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.394em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.345em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> at the point and add up all of \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\| \\gamma'(x) \\|\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7519em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003C/span>\u003C/span>\u003C/span> to obtain the total length of the curve.\u003C/p>\n\u003Cp>To calculate \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\| \\gamma'(x) \\|\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7519em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003C/span>\u003C/span>\u003C/span>:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmsup>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msup>\u003Cmo>=\u003C/mo>\u003Cmo stretchy=\"false\">⟨\u003C/mo>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">⟩\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmsub>\u003Cmi>g\u003C/mi>\u003Cmrow>\u003Cmi>γ\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmsup>\u003Cmi>γ\u003C/mi>\u003Cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′\u003C/mo>\u003C/msup>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\| \\gamma'(x) \\|^2 = ⟨ \\gamma'(x), \\gamma'(x) ⟩ = g_{\\gamma(x)} (\\gamma'(x), \\gamma'(x))\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8019em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">⟨\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8019em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8019em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)⟩\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.1571em;vertical-align:-0.3552em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3448em;\">\u003Cspan style=\"top:-2.5198em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"mopen mtight\">(\u003C/span>\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003Cspan class=\"mclose mtight\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3552em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8019em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8019em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">′\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mclose\">))\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>The square of the modulus of a vector, also known as the Euclidean norm or the \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi mathvariant=\"normal\">ℓ\u003C/mi>\u003Cmn>2\u003C/mn>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\ell_2\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">ℓ\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> norm, is equal to the inner product of the vector with itself. This means that \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>g\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/msub>\u003Cmo>:\u003C/mo>\u003Cmsub>\u003Cmi>T\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/msub>\u003Cmi>M\u003C/mi>\u003Cmo>×\u003C/mo>\u003Cmsub>\u003Cmi>T\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/msub>\u003Cmi>M\u003C/mi>\u003Cmo>→\u003C/mo>\u003Cmi mathvariant=\"double-struck\">R\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">g_x: T_x M \\times T_x M \\to \\Reals\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1514em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">:\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1514em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">×\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1514em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">→\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6889em;\">\u003C/span>\u003Cspan class=\"mord mathbb\">R\u003C/span>\u003C/span>\u003C/span>\u003C/span> defines a \u003Cstrong>metric\u003C/strong>, which is a way of measuring distance, over a tangent space. A metric that varies smoothly with respect to a point on a manifold is known as a \u003Cstrong>Riemannian metric\u003C/strong>, and a manifold equipped with a Riemannian metric is called a \u003Cstrong>Riemannian manifold\u003C/strong>.\u003C/p>\n\u003Cp>As explained \u003Ca href=\"https://www.math.fsu.edu/~whuang2/pdf/ECNU_slides.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">here\u003C/a> (page 4):\u003C/p>\n\u003Cblockquote>\n\u003Cp>Roughly, a Riemannian manifold \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span> is a smooth set with a smoothly-varying inner product on the tangent spaces.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Formally, for each \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>x\u003C/mi>\u003Cmo>∈\u003C/mo>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">x \\in M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span>，a Riemannian metric \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>g\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmsub>\u003Cmi>g\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">g = g_x\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1514em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> satisfies:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>g\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>u\u003C/mi>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmi>v\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmi>g\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>v\u003C/mi>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmi>u\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">g(u, v) = g(v, u)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> for all \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>u\u003C/mi>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmi>v\u003C/mi>\u003Cmo>∈\u003C/mo>\u003Cmsub>\u003Cmi>T\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/msub>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">u, v \\in T_x M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1514em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/li>\n\u003Cli>\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>g\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>u\u003C/mi>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmi>u\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>≥\u003C/mo>\u003Cmn>0\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">g(u, u) \\geq 0\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">≥\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span> for all \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>u\u003C/mi>\u003Cmo>∈\u003C/mo>\u003Cmsub>\u003Cmi>T\u003C/mi>\u003Cmi>x\u003C/mi>\u003C/msub>\u003Cmi>M\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">u \\in T_x M\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1514em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">x\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/li>\n\u003Cli>\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>g\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>u\u003C/mi>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmi>u\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmn>0\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">g(u, u) = 0\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span> if and only if \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>u\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmn>0\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">u = 0\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.4306em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">u\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"natural-gradient-decent\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#natural-gradient-decent\">#\u003C/a>Natural Gradient Decent\u003C/h2>\n\u003Ch3 id=\"constrained-optimization\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#constrained-optimization\">#\u003C/a>Constrained Optimization\u003C/h3>\n\u003Cp>Let’s start with looking at \u003Cstrong>natural gradient decent\u003C/strong> from aspect of constrained optimization. In traditional gradient decent, the constrained optimization problem we want to solve is:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmtable rowspacing=\"0.25em\" columnalign=\"center\" columnspacing=\"0em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmunder>\u003Cmrow>\u003Cmi>min\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003C/mrow>\u003Cmi>d\u003C/mi>\u003C/munder>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmtext>s.t.\u003C/mtext>\u003Cmspace width=\"0.5em\">\u003C/mspace>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmo>≤\u003C/mo>\u003Cmi>ϵ\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cannotation encoding=\"application/x-tex\">\\begin{gathered}\n  \\min_{d} L(\\theta + d) \\\\\n  \\text{s.t.} \\enspace \\| d \\| \\leq \\epsilon\n\\end{gathered}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:3.3921em;vertical-align:-1.4461em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.9461em;\">\u003Cspan style=\"top:-4.1061em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mop op-limits\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6679em;\">\u003Cspan style=\"top:-2.3479em;margin-left:0em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan>\u003Cspan class=\"mop\">min\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7521em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.2139em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord text\">\u003Cspan class=\"mord\">s.t.\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.5em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">≤\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">ϵ\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.4461em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>where the distance in parameter space is contrained and can be calculated using Euclidean metric.\u003C/p>\n\u003Cp>As mentioned \u003Ca href=\"#gradient-decent\">before\u003C/a>, the steepest descent direction is the direction of the negative gradient:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmo>−\u003C/mo>\u003Cmfrac>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003C/mfrac>\u003Cmo>=\u003C/mo>\u003Cmunder>\u003Cmrow>\u003Cmi>lim\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmi>ϵ\u003C/mi>\u003Cmo>→\u003C/mo>\u003Cmn>0\u003C/mn>\u003C/mrow>\u003C/munder>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmi>ϵ\u003C/mi>\u003C/mfrac>\u003Cmi>arg\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmunder>\u003Cmrow>\u003Cmi>min\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmi>d\u003C/mi>\u003Cmtext> s.t.\u003C/mtext>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmo>≤\u003C/mo>\u003Cmi>ϵ\u003C/mi>\u003C/mrow>\u003C/munder>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">- \\frac{\\nabla L(\\theta)}{\\| \\nabla L(\\theta) \\|} = \\lim_{\\epsilon \\to 0} \\frac{1}{\\epsilon} \\arg \\min_{d \\text{ s.t.} \\| d \\| \\leq \\epsilon} L(\\theta + d)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.427em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∥∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.936em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:2.2874em;vertical-align:-0.966em;\">\u003C/span>\u003Cspan class=\"mop op-limits\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6944em;\">\u003Cspan style=\"top:-2.3829em;margin-left:0em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">ϵ\u003C/span>\u003Cspan class=\"mrel mtight\">→\u003C/span>\u003Cspan class=\"mord mtight\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan>\u003Cspan class=\"mop\">lim\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7171em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">ϵ\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop\">ar\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop op-limits\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6679em;\">\u003Cspan style=\"top:-2.309em;margin-left:0em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">d\u003C/span>\u003Cspan class=\"mord text mtight\">\u003Cspan class=\"mord mtight\"> s.t.\u003C/span>\u003C/span>\u003Cspan class=\"mord mtight\">∥\u003C/span>\u003Cspan class=\"mord mathnormal mtight\">d\u003C/span>\u003Cspan class=\"mord mtight\">∥\u003C/span>\u003Cspan class=\"mrel mtight\">≤\u003C/span>\u003Cspan class=\"mord mathnormal mtight\">ϵ\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan>\u003Cspan class=\"mop\">min\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.966em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>When using gradient descent, the distribution of the parameters may change as the optimization process progresses. However, it is also important to ensure that the amount of change in the distribution is controlled, as large changes can lead to instability in the model. The Euclidean distance, which is based on the properties of flat space, may not be an appropriate measure of the amount of change in the distribution. Therefore, natural gradient decent works in \u003Cstrong>distribution space\u003C/strong> and uses KL divergence to compare the current distribution of parameters \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(x \\mid \\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> with the target distribution \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(x \\mid \\theta + d)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>. Now the constraint becomes:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmtext>s.t.\u003C/mtext>\u003Cmspace width=\"0.5em\">\u003C/mspace>\u003Cmi>K\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">(\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">)\u003C/mo>\u003Cmo>≤\u003C/mo>\u003Cmi>ϵ\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\text{s.t.} \\enspace KL \\Big ( p(x \\mid \\theta) \\| p(x \\mid \\theta + d) \\Big ) \\leq \\epsilon\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\">\u003C/span>\u003Cspan class=\"mord text\">\u003Cspan class=\"mord\">s.t.\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.5em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">(\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">)\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">≤\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.4306em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">ϵ\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>We apply the Lagrange multiplier method to it:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmo>∗\u003C/mo>\u003C/msup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmi>arg\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmunder>\u003Cmrow>\u003Cmi>min\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003C/mrow>\u003Cmi>d\u003C/mi>\u003C/munder>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi>λ\u003C/mi>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">(\u003C/mo>\u003Cmi>K\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(\u003C/mo>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmi mathvariant=\"normal\">∣\u003C/mi>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmi mathvariant=\"normal\">∣\u003C/mi>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmi>ϵ\u003C/mi>\u003Cmo fence=\"false\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">)\u003C/mo>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>≈\u003C/mo>\u003Cmi>arg\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003Cmunder>\u003Cmrow>\u003Cmi>min\u003C/mi>\u003Cmo>⁡\u003C/mo>\u003C/mrow>\u003Cmi>d\u003C/mi>\u003C/munder>\u003Cmunder>\u003Cmunder>\u003Cmrow>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmsup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003Cmo stretchy=\"true\">⏟\u003C/mo>\u003C/munder>\u003Cmtext>first order Taylor expansion\u003C/mtext>\u003C/munder>\u003Cmo>+\u003C/mo>\u003Cmunder>\u003Cmunder>\u003Cmrow>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmi>λ\u003C/mi>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>F\u003C/mi>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003Cmo stretchy=\"true\">⏟\u003C/mo>\u003C/munder>\u003Cmtext>second order Taylor expansion\u003C/mtext>\u003C/munder>\u003Cmo>−\u003C/mo>\u003Cmi>λ\u003C/mi>\u003Cmi>ϵ\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cannotation encoding=\"application/x-tex\">\\begin{aligned}\n  d^* &#x26;= \\arg \\min_{d} L(\\theta + d) + \\lambda \\Big ( KL \\big ( p(x | \\theta) \\| p(x | \\theta + d) \\big ) - \\epsilon \\Big )  \\\\\n    &#x26;\\approx \\arg \\min_{d} \\underbrace{L(\\theta) + \\nabla L(\\theta)^T d}_{\\text{first order Taylor expansion}} + \\underbrace{\\frac{1}{2} \\lambda d^T F d}_{\\text{second order Taylor expansion}} - \\lambda \\epsilon\n\\end{aligned}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:5.9798em;vertical-align:-2.7399em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-r\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:3.2399em;\">\u003Cspan style=\"top:-5.4113em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7387em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mbin mtight\">∗\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.0378em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.7399em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"col-align-l\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:3.2399em;\">\u003Cspan style=\"top:-5.4113em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mop\">ar\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop op-limits\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6679em;\">\u003Cspan style=\"top:-2.3479em;margin-left:0em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan>\u003Cspan class=\"mop\">min\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7521em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">(\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size1\">(\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mord\">∣\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mord\">∣\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size1\">)\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">ϵ\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"delimsizing size2\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.0378em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">≈\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mop\">ar\u003Cspan style=\"margin-right:0.01389em;\">g\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mop op-limits\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.6679em;\">\u003Cspan style=\"top:-2.3479em;margin-left:0em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan>\u003Cspan class=\"mop\">min\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.7521em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord munder\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-1.4159em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord text mtight\">\u003Cspan class=\"mord mtight\">first order Taylor expansion\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord munder\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan class=\"svg-align\" style=\"top:-2.102em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\">\u003Cspan class=\"brace-left\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMinYMin slice\">\u003Cpath d=\"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-center\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMidYMin slice\">\u003Cpath d=\"M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-right\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMaxYMin slice\">\u003Cpath d=\"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.898em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.7202em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord munder\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-1.3013em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord text mtight\">\u003Cspan class=\"mord mtight\">second order Taylor expansion\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3214em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"mord munder\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan class=\"svg-align\" style=\"top:-1.9874em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\">\u003Cspan class=\"brace-left\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMinYMin slice\">\u003Cpath d=\"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-center\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMidYMin slice\">\u003Cpath d=\"M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z\">\u003C/path>\u003C/svg>\u003C/span>\u003Cspan class=\"brace-right\" style=\"height:0.548em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"0.548em\" viewBox=\"0 0 400000 548\" preserveAspectRatio=\"xMaxYMin slice\">\u003Cpath d=\"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3214em;\">\u003Cspan class=\"pstrut\" style=\"height:3.3214em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.334em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.1562em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003Cspan class=\"mord mathnormal\">ϵ\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.7399em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>To solve this minimization, we set its derivative to zero:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmfrac>\u003Cmi mathvariant=\"normal\">∂\u003C/mi>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∂\u003C/mi>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003C/mfrac>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmsup>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>d\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmi>λ\u003C/mi>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>F\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmo>−\u003C/mo>\u003Cmi>λ\u003C/mi>\u003Cmi>ϵ\u003C/mi>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>+\u003C/mo>\u003Cmi>λ\u003C/mi>\u003Cmi>F\u003C/mi>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmi>λ\u003C/mi>\u003Cmi>F\u003C/mi>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmi>d\u003C/mi>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"true\">\u003Cmrow>\u003Cmrow>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmo>−\u003C/mo>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmi>λ\u003C/mi>\u003C/mfrac>\u003Cmsup>\u003Cmi>F\u003C/mi>\u003Cmrow>\u003Cmo>−\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msup>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cannotation encoding=\"application/x-tex\">\\begin{aligned}\n  0 &#x26;= \\frac{\\partial}{\\partial d} \\left [ L(\\theta) + \\nabla L(\\theta)^T d + \\frac{1}{2} \\lambda d^T F d  - \\lambda \\epsilon \\right ] \\\\\n    &#x26;= \\nabla L(\\theta) + \\lambda F d \\\\\n  \\lambda F d &#x26;= -\\nabla L(\\theta) \\\\\n  d &#x26;= - \\frac{1}{\\lambda} F^{-1} \\nabla L(\\theta)\n\\end{aligned}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:8.0075em;vertical-align:-3.7537em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-r\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:4.2537em;\">\u003Cspan style=\"top:-6.2537em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-4.1637em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.6637em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-0.6823em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:3.7537em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"col-align-l\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:4.2537em;\">\u003Cspan style=\"top:-6.2537em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3714em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\" style=\"margin-right:0.05556em;\">∂\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\" style=\"margin-right:0.05556em;\">∂\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">[\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8913em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">−\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003Cspan class=\"mord mathnormal\">ϵ\u003C/span>\u003Cspan class=\"mclose delimcenter\" style=\"top:0em;\">\u003Cspan class=\"delimsizing size3\">]\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-4.1637em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.6637em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-0.6823em;\">\u003Cspan class=\"pstrut\" style=\"height:3.45em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mord\">−\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.3214em;\">\u003Cspan style=\"top:-2.314em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">λ\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.677em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.686em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8641em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">−\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:3.7537em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>Finally, the optimal descent direction is \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmover accent=\"true\">\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmo>~\u003C/mo>\u003C/mover>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003Cmo>=\u003C/mo>\u003Cmsup>\u003Cmi>F\u003C/mi>\u003Cmrow>\u003Cmo>−\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msup>\u003Cmi mathvariant=\"normal\">∇\u003C/mi>\u003Cmi>L\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\tilde{\\nabla} L(\\theta) = F^{-1} \\nabla L(\\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.1702em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord accent\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.9202em;\">\u003Cspan style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.6023em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"accent-body\" style=\"left:-0.25em;\">\u003Cspan class=\"mord\">~\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">−\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">∇\u003C/span>\u003Cspan class=\"mord mathnormal\">L\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> (constant factor can be absorbed into the learning rate), called \u003Cstrong>natural gradient\u003C/strong>.\u003C/p>\n\u003Ch3 id=\"riemannian-manifold-1\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#riemannian-manifold-1\">#\u003C/a>Riemannian Manifold\u003C/h3>\n\u003Cp>Now we consider optimizing the objective function on a manifold. We can easily recognize that the descent direction depends on how to calculate \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003Cmi>d\u003C/mi>\u003Cmi mathvariant=\"normal\">∥\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\|d\\|\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mord\">∥\u003C/span>\u003C/span>\u003C/span>\u003C/span>, i.e., what’s the metric on the manifold.\u003C/p>\n\u003Cp>The tranditional gradient decent works on parameter space (a Euclidean space), of which the metric is Euclidean metric. The natural gradient descent operates in distribution space (a Riemannian manifold), in which a point, represented by \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(x \\mid \\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>, can be thought of as a parameterized probability distribution. When the parameter \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>θ\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\theta\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003C/span>\u003C/span>\u003C/span> changes to \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\theta + d\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6944em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>, the distance between \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(x \\mid \\theta)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>p\u003C/mi>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmi>x\u003C/mi>\u003Cmo>∣\u003C/mo>\u003Cmi>θ\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>d\u003C/mi>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">p(x \\mid \\theta + d)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">p\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">∣\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> is \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmfrac>\u003Cmn>1\u003C/mn>\u003Cmn>2\u003C/mn>\u003C/mfrac>\u003Cmsup>\u003Cmi>d\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>F\u003C/mi>\u003Cmi>d\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\frac{1}{2} d^T F d\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mopen nulldelimiter\">\u003C/span>\u003Cspan class=\"mfrac\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8451em;\">\u003Cspan style=\"top:-2.655em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.23em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\">\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.394em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.345em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose nulldelimiter\">\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8413em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\">d\u003C/span>\u003C/span>\u003C/span>\u003C/span>. It can be seen that the Fisher information matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span> serves as the Riemannian metric on this Riemannian manifold.\u003C/p>\n\u003Cp>The Fisher information matrix reflects the local curvature of the likelihood probability distribution space, which means that it encodes information about how much the probability distribution changes as the parameters vary. By using the Fisher information matrix as a measure, we can obtain the descent direction that takes into account the curvature of the probability distribution space. This is important because the larger the curvature, the smaller the range of parameter values that can be used to maintain a given likelihood. Natural gradient descent ensures that the optimization process respects the underlying geometry of the probability distribution space and avoids making large, unstable changes to the parameters.\u003C/p>\n\u003Ch2 id=\"references\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#references\">#\u003C/a>References\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://agustinus.kristia.de/techblog/2018/03/14/natural-gradient/\" rel=\"noopener noreferrer\" target=\"_blank\">Natural Gradient Descent\u003C/a>. \u003Cem>Agustinus Kristiadi\u003C/em>.\u003C/li>\n\u003Cli>\u003Ca href=\"https://maths-people.anu.edu.au/~andrews/DG/\" rel=\"noopener noreferrer\" target=\"_blank\">Differential Geometry\u003C/a>. \u003Cem>Ben Andrews\u003C/em>. Australian National University.\u003C/li>\n\u003Cli>\u003Ca href=\"http://people.maths.ox.ac.uk/~joyce/Nairobi2019/Hitchin-DifferentiableManifolds.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">Differential Geometry\u003C/a>. \u003Cem>Nigel Hitchin\u003C/em>. Oxford University.\u003C/li>\n\u003Cli>\u003Ca href=\"https://www.ime.usp.br/~gorodski/teaching/mat5771/ch1.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">Riemannian Metrics\u003C/a>. \u003Cem>Claudio Gorodski\u003C/em>. University of São Paulo.\u003C/li>\n\u003Cli>\u003Ca href=\"https://arxiv.org/abs/1611.08097\" rel=\"noopener noreferrer\" target=\"_blank\">Geometric Deep Learning: Going beyond Euclidean Data\u003C/a>. IEEE Signal Processing Magazine 2017. \u003Cem>Michael M. Bronstein, et al\u003C/em>.\u003C/li>\n\u003C/ul>",{"headings":85,"localImagePaths":124,"remoteImagePaths":125,"frontmatter":126,"imagePaths":128},[86,89,93,96,99,102,105,109,112,115,118,121],{"depth":23,"slug":87,"text":88},"preliminary","#Preliminary",{"depth":90,"slug":91,"text":92},3,"gradient-decent","#Gradient Decent",{"depth":90,"slug":94,"text":95},"kl-divergence","#KL Divergence",{"depth":90,"slug":97,"text":98},"fisher-information-matrix","#Fisher Information Matrix",{"depth":90,"slug":100,"text":101},"kl-divergence--fisher-information","#KL Divergence & Fisher Information",{"depth":90,"slug":103,"text":104},"riemannian-manifold","#Riemannian manifold",{"depth":106,"slug":107,"text":108},4,"manifold","#Manifold",{"depth":106,"slug":110,"text":111},"riemannian-metric","#Riemannian Metric",{"depth":23,"slug":113,"text":114},"natural-gradient-decent","#Natural Gradient Decent",{"depth":90,"slug":116,"text":117},"constrained-optimization","#Constrained Optimization",{"depth":90,"slug":119,"text":120},"riemannian-manifold-1","#Riemannian Manifold",{"depth":23,"slug":122,"text":123},"references","#References",[],[],{"title":75,"tags":127},[77,78],[],"2022-12-19-monocular-visual-odometry",{"id":129,"data":131,"body":135,"filePath":136,"digest":137,"rendered":138},{"title":132,"tags":133},"Implement Monocular Visual Odometry",[134],"computer vision","## toc\n\nMonocular Visual Odometry (VO) is the process of estimating the pose (position and orientation) of a camera using only visual information from a single camera. It is a crucial component of many robotics and augmented reality systems, as it allows a device to understand its own movement and position in the world.\n\nThis blog would be focussing on how to implement a simple monocular VO algorithm in Python. If you are new to it, I suggest having a look at [this article](https://cmsc426.github.io/sfm/).\n\nThe overall process can be broken down into the following steps:\n\n- Feature detection\n- Feature tracking\n- Estimating fundamental matrix\n- Estimating essential matrix (from fundamental matrix)\n- Recovering pose (from essential matrix)\n\n## Problem\n\nSuppose that we have a camera attached to a vehicle. A video coming from this camera has been processed for lens distortion and converted to frames. We denote the frames captured at time $i$ and $i+1$ as $I_i$ and $I_{i+1}$, respectively. For every pair of images $(I_i, I_{i+1})$, our job is to find the rotation matrix $R_i$ and the translation vector $t_i$, which describe the motion of the vehicle between the two frames.\n\n## Feature Detection\n\nWe first look for salient landmarks, called keypoints $K_i$, in $I_i$. Keypoints are features that differ from their immediate neighborhood such as corners or areas with unique colors or textures. These features should ideally be found in both two adjacent frames.\n\nUsing OpenCV, detecting keypoints is trivial:\n\n```python\nimport cv2\n\ndef detect_features(image):\n    detector = cv2.GFTTDetector_create()\n\n    kp = detector.detect(image)\n    kp = cv2.KeyPoint_convert(sorted(kp, key=lambda p: p.response, reverse=True))\n\n    return kp\n\nkp1 = detect_features(image1)\n```\n\nHere GFTT (Good Features to Track) detector is used to detect keypoints. In my experiments, other detectors like SIFT (Scale Invariant Feature Transform) and ORB (Oriented Fast and Rotated Brief) perform worse than GFTT. Meanwhile, the speed of SIFT is much slower.\n\n## Feature Tracking\n\nWe then need to track $K_i$'s corresponding keypoints $K_{i+1}$ in $I_{i+1}$ using optical flow. To improve the performance, you can choose to remove the keypoints that are not tracked in $I_{i+1}$ (`status` returned by `cv2.calcOpticalFlowPyrLK` is 0) or are outside $I_{i+1}$.\n\n```python\ndef get_removed_pts_ids(pts, image, status):\n    \"\"\"Removes keypoints that are not tracked or are outside the image.\"\"\"\n    status_ = status.copy()\n\n    for idx, pt in enumerate(pts):\n        if pt[0] \u003C 0 or pt[1] \u003C 0 or pt[0] > image.shape[1] or pt[1] > image.shape[0]:\n            status_[idx] = 0\n\n    return np.where(status_ == 0)[0]\n\ndef track_features(image1, image2, kp1, remove_outliers: bool = False):\n    \"\"\"Tracks features using optical flow.\"\"\"\n    kp2, status, _ = cv2.calcOpticalFlowPyrLK(image1, image2, kp1, None)\n\n    if remove_outliers:\n        removed_ids = get_removed_pts_ids(kp2, image2, status)\n        kp1 = np.delete(kp1, removed_ids, axis=0)\n        kp2 = np.delete(kp2, removed_ids, axis=0)\n\n    return kp1, kp2\n\nkp1, kp2 = track_features(image1, image2, kp1, remove_outliers=True)\n```\n\n## Fundamental Matrix\n\nThe fundamental matrix $F = \\begin{bmatrix}\n    f_{11} & f_{12} & f_{13} \\\\\n    f_{21} & f_{22} & f_{23} \\\\\n    f_{31} & f_{32} & f_{33}\n\\end{bmatrix}$ is a $3 \\times 3$ matrix that encodes the relative orientation and position of the camera between $I_i$ and $I_{i+1}$.\n\n### 8-Point Algorithm\n\nTo estimate $F$, one of the solutions is [Hartley's normalized 8-point algorithm](https://www.cs.cmu.edu/~16385/s17/Slides/12.4_8Point_Algorithm.pdf), where the constraint for $F$ is:\n\n$$\n\\begin{bmatrix}\n    x_{i+1}^1 x_i^1 & x_{i+1}^1 y_i^1 & x_{i+1}^1 & y_{i+1}^1 x_i^1 & y_{i+1}^1 y_i^1 & y_{i+1}^1 & x_i^1 & y_i^1 & 1 \\\\\n    \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots &  \\vdots \\\\\n    x_{i+1}^8 x_i^8 & x_{i+1}^8 y_i^8 & x_{i+1}^8 & y_{i+1}^8 x_i^8 & y_{i+1}^8 y_i^8 & y_{i+1}^8 & x_i^8 & y_i^8 & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n    f_{11} \\\\\n    f_{12} \\\\\n    f_{13} \\\\\n    f_{21} \\\\\n    f_{22} \\\\\n    f_{23} \\\\\n    f_{31} \\\\\n    f_{32} \\\\\n    f_{33}\n\\end{bmatrix}\n= 0,\n$$\n\nwhich can be answered by solving the linear least squares using Singular Value Decomposition (SVD). This algorithm requires 8 keypoint correspondences exists, where $(x_i, y_i)$ are the coordinates of the 8 keypoints selected from $K_i$, and $(x_{i+1}, y_{i+1})$ are the coordinates of their corresponding keypoints in $K_{i+1}$. The coordinates should be normalized by shifting them around the mean of the points and enclosing them at a distance of $\\sqrt{2}$ from the new center.\n\nGiven 8 keypoint correspondences, the code for computing $F$ is:\n\n```python\nimport numpy as np\n\ndef normalize(pt: np.ndarray):\n    \"\"\"Normalizes the given set of points.\"\"\"\n    N = pt.shape[0]\n    mean = pt - np.mean(pt, axis=0)\n\n    scale = np.sum(np.square(pt)) / (2 * N)\n    scale = np.sqrt(1 / scale)\n\n    return scale * mean, scale\n\ndef compute_fundamental_mat(pt1: np.ndarray, pt2: np.ndarray)-> np.ndarray:\n    \"\"\"Computes the fundamental matrix F using SVD.\"\"\"\n    N = pt1.shape[0]\n\n    norm_pt1, scale1 = normalize(pt1)\n    norm_pt2, scale2 = normalize(pt2)\n\n    T1 = np.array([\n        [scale1, 0, - scale1 * np.mean(pt1[:, 0])],\n        [0, scale1, - scale1 * np.mean(pt1[:, 1])],\n        [0, 0, 1]\n    ])\n\n    T2 = np.array([\n        [scale2, 0, - scale2 * np.mean(pt2[:, 0])],\n        [0, scale2, - scale2 * np.mean(pt2[:, 1])],\n        [0, 0, 1]\n    ])\n\n    A = []\n\n    for i in range(N):\n        x1, y1 = norm_pt1[i]\n        x2, y2 = norm_pt2[i]\n\n        a = np.array([x2 * x1, x2 * y1, x2, y2 * x1, y2 * y1, y2, x1, y1, 1])\n        A.append(a)\n\n    A = np.array(A)  # (N, 9)\n\n    U1, S1, V1 = np.linalg.svd(A)\n    F = V1[-1,:].reshape(3, 3)\n    F /= F[2, 2]\n\n    U2, S2, V2 = np.linalg.svd(F)\n    S2 = np.diag(S2)\n    S2[-1] = 0\n\n    F = U2 @ S2 @ V2\n    F = T2.T @ F @ T1\n\n    return F\n```\n\n### RANSAC\n\nOur feature detection and tracking algorithms are not perfect, leading to several erroneous correspondences (outliers). Therefore, RANSAC is used to remove these outliers.\n\nRANSAC is an iterative algorithm terminating after a fixed number of iterations. At every iteration, it works in the following way:\n\n- Picks 8 keypoint correspondences from $K_i$ and $K_{i+1}$\n- Computes $F$ using Hartley's 8-point algorithm mentioned above\n- Determines how many of all other keypoints are inliers\n\nFinally, the $F$ with the maximum number of inliers will be used.\n\n```python\ndef compute_ransac_error(F: np.ndarray, pt1: np.ndarray, pt2: np.ndarray):\n    n = pt1.shape[0]\n\n    p1 = np.hstack((pt1, np.ones((n, 1))))\n    p2 = np.hstack((pt2, np.ones((n, 1))))\n\n    e1 = p1 @ F.T\n    e2 = p2 @ F\n\n    error = np.sum(e2 * p1, axis=1, keepdims=True) ** 2 / np.sum(np.hstack((e1[:, :-1], e2[:, :-1])) ** 2, axis=1, keepdims=True)\n    return error\n\ndef find_fundamental_mat(\n    pt1: np.ndarray, pt2: np.ndarray, threshold: float = 0.05\n)-> np.ndarray:\n    \"\"\"Estimates the fundamental matrix using RANSAC.\"\"\"\n    max_inliers = 0\n    best_F = None\n    confidence = 0.99\n\n    N = sys.maxsize\n    count = 0\n\n    while N > count:\n        x, y = sample_eight_points(pt1, pt2)\n\n        F = compute_fundamental_mat(x, y)\n        error = compute_ransac_error(F, pt1, pt2)\n\n        inliers = error \u003C= threshold\n        n_inliers = np.sum(inliers)\n\n        if max_inliers \u003C np.sum(inliers):\n            max_inliers = n_inliers\n            best_F = F.copy()\n\n        ratio = n_inliers / len(pt1)\n        if np.log(1 - (ratio ** 8)) == 0:\n            continue\n        N = np.log(1 - confidence) / np.log(1 - (ratio ** 8))\n\n        count += 1\n\n    return best_F\n\nF = find_fundamental_mat(kp1, kp2, 0.05)\n```\n\nThen the problem is how to pick 8 keypoint correspondences (`sample_eight_points`). While Hartley's 8-point algorithm samples them randomly, to make the algorithm more robust to outliers, we can use the way mentioned [here](https://www.crcv.ucf.edu/wp-content/uploads/2019/03/Lecture-13-FundamentalMatrix.pdf) (page 39) instead: uniformly dividing a frame into an $8 \\times 8$ grid, then randomly selecting 8 grid cells and picking one pair of corresponding keypoints from each grid cell.\n\n## Essential Matrix\n\nEssential matrix $E$ is another $3 \\times 3$ matrix. But unlike $F$, $E$ assumes that the cameras obey the pinhole model. More specifically, given the camera calibration matrix $K$, $E = K^T F K$, which also can be solved using SVD.\n\n```python {6-10,12}\ndef find_essential_mat(K: np.ndarray, F: np.ndarray)-> np.ndarray:\n    \"\"\"Estimates the essential matrix.\"\"\"\n    E = K.T @ F @ K\n\n    U, S, V = np.linalg.svd(E)\n    S = np.asarray([\n        [1, 0, 0],\n        [0, 1, 0],\n        [0, 0, 0]\n    ])\n\n    E = U @ S @ V\n    E = E / np.linalg.norm(E)\n\n    return E\n\nE = find_essential_mat(K, F)\n```\n\nNote that the singular values of $E$ are not necessarily $(1, 1, 0)$ due to the noise in K. Thus $E$ should be reconstructed with $(1, 1, 0)$ singular values:\n\n$$\nE = U\n\n\\begin{bmatrix}\n    1 & 0 & 0 \\\\\n    0 & 1 & 0 \\\\\n    0 & 0 & 0 \\\\\n\\end{bmatrix}\n\nV^\\top\n$$\n\n---\n\nNow we have successfully estimated the essential matrix $E$ manually, looks cool! However, this can also be done with the help of OpenCV, and all you need is one line:\n\n```python\nE, mask = cv2.findEssentialMat(kp2, kp1, K, cv2.RANSAC, 0.999, 0.3, None)\n```\n\nOpenCV uses [Nistér's 5-point algorithm](https://www-users.cse.umn.edu/~hspark/CSci5980/nister.pdf), a more recent approach that is shown to give better results, to compute $E$. It requires the minimum number of keypoints possible since $E$ has only 5 degrees of freedom ($F$ has 7 degrees of freedom, $E$ has only 5 as it takes camera parameters into account).\n\n## Camera Pose\n\nJust follow [here](https://cmsc426.github.io/sfm/#essential) to recover the camera rotation matrix $R_i$ and translation vector $t_i$ from $E$.\n\n```python\ndef linear_triangulation(\n    T1: np.ndarray,\n    R1: np.ndarray,\n    T2: np.ndarray,\n    R2: np.ndarray,\n    pt1: np.ndarray,\n    pt2: np.ndarray,\n    K: np.ndarray,\n)-> np.ndarray:\n    \"\"\"Linear triangulation.\"\"\"\n    P1 = K @ np.hstack((R1, -R1 @ T1))\n    P2 = K @ np.hstack((R2, -R2 @ T2))\n\n    X = []\n\n    for i in range(len(pt1)):\n        x1, x2 = pt1[i], pt2[i]\n\n        A1 = x1[0] * P1[2, :] - P1[0, :]\n        A2 = x1[1] * P1[2, :] - P1[1, :]\n        A3 = x2[0] * P2[2, :] - P2[0, :]\n        A4 = x2[1] * P2[2, :] - P2[1, :]\n\n        A = np.asarray([A1, A2, A3, A4])\n        U, S, V = np.linalg.svd(A)\n\n        V = V[3]\n        V = V / V[-1]\n\n        X.append(V)\n\n    return np.asarray(X)\n\ndef recover_pose(E: np.ndarray, pt1, pt2, K: np.ndarray):\n    \"\"\"Recovers the camera pose.\"\"\"\n    W = np.asarray([\n        [0, -1, 0],\n        [1,  0, 0],\n        [0,  0, 1]\n    ])\n    U, S, V = np.linalg.svd(E)\n\n    poses = {\n        \"T1\":  U[:, 2].reshape(3, 1),\n        \"T2\": -U[:, 2].reshape(3, 1),\n        \"T3\":  U[:, 2].reshape(3, 1),\n        \"T4\": -U[:, 2].reshape(3, 1),\n        \"R1\":  U @ W   @ V,\n        \"R2\":  U @ W   @ V,\n        \"R3\":  U @ W.T @ V,\n        \"R4\":  U @ W.T @ V\n    }\n\n    for i in range(1, 5):\n        T, R = poses[\"T\" + str(i)], poses[\"R\" + str(i)]\n\n        if np.linalg.det(R) \u003C 0:\n            T = -T\n            R = -R\n            poses[\"T\" + str(i)], poses[\"R\" + str(i)] = T, R\n\n        I = np.identity(3)\n        M = np.hstack((I, T.reshape(3, 1)))\n\n        poses[\"P\" + str(i)] = K @ R @ M\n\n    max_Z, rt_idx = 0, 1\n\n    for i in range(1, 5):\n        T1, R1 = poses[\"T\" + str(i)], poses[\"R\" + str(i)]\n\n        # ---------------------\n        T2, R2 = np.asarray([[0],[0],[0]]), np.identity(3)\n\n        X = linear_triangulation(T2, R2, T1, R1, pt1, pt2, K)\n        Z = 0\n\n        for j in range(X.shape[0]):\n            x = X[j, :].reshape(-1, 1)\n            if R1[2] @ np.subtract(x[0:3], T1) > 0 and x[2] > 0:\n                Z += 1\n        # ---------------------\n\n        if max_Z \u003C Z:\n            max_Z, rt_idx = Z, str(i)\n\n    cur_T, cur_R = poses[\"T\" + rt_idx], poses[\"R\" + rt_idx]\n\n    if cur_T[2] \u003C 0:\n        cur_T = -cur_T\n\n    return cur_T, cur_R\n\ncur_T, cur_R = recover_pose(E, kp1, kp2, K)\n```\n\n---\n\nAgain, here is how to implement it in OpenCV:\n\n```python\nkp1 = np.array([pt for (idx, pt) in enumerate(kp1) if mask[idx] == 1])\nkp2 = np.array([pt for (idx, pt) in enumerate(kp2) if mask[idx] == 1])\n_, cur_R, cur_t, _ = cv2.recoverPose(E, kp2, kp1, K)\n```\n\n## Trajectory\n\nDenote the pose of the camera as $R$ and $t$, which should be initialized as:\n\n```python\nR, T = np.identity(3), np.zeros((3, 1))\n```\n\nWe can update the trajectory of the camera by:\n\n$$\nt = t + R t_i\n$$\n\n$$\nR = R_i R\n$$\n\n```python\nT = T + R @ cur_T\nR = cur_R @ R\n```\n\nThat's it! We can now move to the next pair of frames $(I_{i+1}, I_{i+2})$ and repeat from [here](#feature-detection).\n\nOf course, there are many details and optimizations (e.g. bundle adjustment) that can be added to improve the accuracy and performance of the VO system, but this should give a good starting point for building a monocular VO system.\n\n## References\n\n- [Structure from Motion (University of Maryland)](https://cmsc426.github.io/sfm/)\n- [The 8-point algorithm (Carnegie Mellon University)](https://www.cs.cmu.edu/~16385/s17/Slides/12.4_8Point_Algorithm.pdf)\n- [Fundamental Matrix (University of Central Florida)](https://www.crcv.ucf.edu/wp-content/uploads/2019/03/Lecture-13-FundamentalMatrix.pdf)\n- [An Efficient Solution to the Five-Point Relative Pose Problem](https://www-users.cse.umn.edu/~hspark/CSci5980/nister.pdf). _David Nistér_. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2004.\n- [Monocular Visual Odometry using OpenCV](https://avisingh599.github.io/vision/monocular-vo/)","src/content/blog/2022-12-19-monocular-visual-odometry.md","03e5458f9438f1ba",{"html":139,"metadata":140},"\u003Cul class=\"table-of-contents\">\n\u003Cli>\n\u003Cp>\u003Ca href=\"#problem\">Problem\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#feature-detection\">Feature Detection\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#feature-tracking\">Feature Tracking\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#fundamental-matrix\">Fundamental Matrix\u003C/a>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ca href=\"#_8-point-algorithm\">8-Point Algorithm\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#ransac\">RANSAC\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#essential-matrix\">Essential Matrix\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#camera-pose\">Camera Pose\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#trajectory\">Trajectory\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ca href=\"#references\">References\u003C/a>\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>Monocular Visual Odometry (VO) is the process of estimating the pose (position and orientation) of a camera using only visual information from a single camera. It is a crucial component of many robotics and augmented reality systems, as it allows a device to understand its own movement and position in the world.\u003C/p>\n\u003Cp>This blog would be focussing on how to implement a simple monocular VO algorithm in Python. If you are new to it, I suggest having a look at \u003Ca href=\"https://cmsc426.github.io/sfm/\" rel=\"noopener noreferrer\" target=\"_blank\">this article\u003C/a>.\u003C/p>\n\u003Cp>The overall process can be broken down into the following steps:\u003C/p>\n\u003Cul>\n\u003Cli>Feature detection\u003C/li>\n\u003Cli>Feature tracking\u003C/li>\n\u003Cli>Estimating fundamental matrix\u003C/li>\n\u003Cli>Estimating essential matrix (from fundamental matrix)\u003C/li>\n\u003Cli>Recovering pose (from essential matrix)\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"problem\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#problem\">#\u003C/a>Problem\u003C/h2>\n\u003Cp>Suppose that we have a camera attached to a vehicle. A video coming from this camera has been processed for lens distortion and converted to frames. We denote the frames captured at time \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6595em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">i+1\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">i\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span> as \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>, respectively. For every pair of images \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">(I_i, I_{i+1})\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span>, our job is to find the rotation matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>R\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">R_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> and the translation vector \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>t\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">t_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>, which describe the motion of the vehicle between the two frames.\u003C/p>\n\u003Ch2 id=\"feature-detection\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#feature-detection\">#\u003C/a>Feature Detection\u003C/h2>\n\u003Cp>We first look for salient landmarks, called keypoints \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>K\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>, in \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>. Keypoints are features that differ from their immediate neighborhood such as corners or areas with unique colors or textures. These features should ideally be found in both two adjacent frames.\u003C/p>\n\u003Cp>Using OpenCV, detecting keypoints is trivial:\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">import\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cv2\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> detect_features\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(image):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    detector \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cv2.GFTTDetector_create()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    kp \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> detector.detect(image)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    kp \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cv2.KeyPoint_convert(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">sorted\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(kp, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">key\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=lambda\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> p: p.response, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">reverse\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">True\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> kp\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">kp1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> detect_features(image1)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Cp>Here GFTT (Good Features to Track) detector is used to detect keypoints. In my experiments, other detectors like SIFT (Scale Invariant Feature Transform) and ORB (Oriented Fast and Rotated Brief) perform worse than GFTT. Meanwhile, the speed of SIFT is much slower.\u003C/p>\n\u003Ch2 id=\"feature-tracking\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#feature-tracking\">#\u003C/a>Feature Tracking\u003C/h2>\n\u003Cp>We then need to track \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>K\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>‘s corresponding keypoints \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>K\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> in \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> using optical flow. To improve the performance, you can choose to remove the keypoints that are not tracked in \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> (\u003Ccode>status\u003C/code> returned by \u003Ccode>cv2.calcOpticalFlowPyrLK\u003C/code> is 0) or are outside \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>.\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> get_removed_pts_ids\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(pts, image, status):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Removes keypoints that are not tracked or are outside the image.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    status_ \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> status.copy()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> idx, pt \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(pts):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">        if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> or\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> or\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">>\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> image.shape[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">or\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">>\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> image.shape[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            status_[idx] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.where(status_ \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">==\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> track_features\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(image1, image2, kp1, remove_outliers: \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">bool\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> False\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Tracks features using optical flow.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    kp2, status, _ \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cv2.calcOpticalFlowPyrLK(image1, image2, kp1, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">None\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> remove_outliers:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        removed_ids \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> get_removed_pts_ids(kp2, image2, status)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        kp1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.delete(kp1, removed_ids, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">axis\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        kp2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.delete(kp2, removed_ids, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">axis\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> kp1, kp2\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">kp1, kp2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> track_features(image1, image2, kp1, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">remove_outliers\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">True\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Ch2 id=\"fundamental-matrix\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#fundamental-matrix\">#\u003C/a>Fundamental Matrix\u003C/h2>\n\u003Cp>The fundamental matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>11\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>12\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>13\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>21\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>22\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>23\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>31\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>32\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>33\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F = \\begin{bmatrix}\n    f_{11} &#x26; f_{12} &#x26; f_{13} \\\\\n    f_{21} &#x26; f_{22} &#x26; f_{23} \\\\\n    f_{31} &#x26; f_{32} &#x26; f_{33}\n\\end{bmatrix}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.05em;\">\u003Cspan class=\"pstrut\" style=\"height:5.6em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:3.600em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"3.600em\" viewBox=\"0 0 667 3600\">\u003Cpath d=\"M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v0 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.21em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">11\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.01em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">21\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">31\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.21em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">12\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.01em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">22\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">32\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.21em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">13\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.01em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">23\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">33\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.05em;\">\u003Cspan class=\"pstrut\" style=\"height:5.6em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:3.600em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"3.600em\" viewBox=\"0 0 667 3600\">\u003Cpath d=\"M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v0 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> is a \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmn>3\u003C/mn>\u003Cmo>×\u003C/mo>\u003Cmn>3\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">3 \\times 3\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord\">3\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">×\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">3\u003C/span>\u003C/span>\u003C/span>\u003C/span> matrix that encodes the relative orientation and position of the camera between \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">I_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>.\u003C/p>\n\u003Ch3 id=\"_8-point-algorithm\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#_8-point-algorithm\">#\u003C/a>8-Point Algorithm\u003C/h3>\n\u003Cp>To estimate \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span>, one of the solutions is \u003Ca href=\"https://www.cs.cmu.edu/~16385/s17/Slides/12.4_8Point_Algorithm.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">Hartley’s normalized 8-point algorithm\u003C/a>, where the constraint for \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span> is:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmtable rowspacing=\"0.16em\" columnalign=\"center center center center center center center center center\" columnspacing=\"1em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>1\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>1\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmi mathvariant=\"normal\">⋮\u003C/mi>\u003Cmpadded height=\"0em\" voffset=\"0em\">\u003Cmspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\">\u003C/mspace>\u003C/mpadded>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmrow>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mrow>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>x\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsubsup>\u003Cmi>y\u003C/mi>\u003Cmi>i\u003C/mi>\u003Cmn>8\u003C/mn>\u003C/msubsup>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>1\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>11\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>12\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>13\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>21\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>22\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>23\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>31\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>32\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmsub>\u003Cmi>f\u003C/mi>\u003Cmn>33\u003C/mn>\u003C/msub>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003Cmo>=\u003C/mo>\u003Cmn>0\u003C/mn>\u003Cmo separator=\"true\">,\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\begin{bmatrix}\n    x_{i+1}^1 x_i^1 &#x26; x_{i+1}^1 y_i^1 &#x26; x_{i+1}^1 &#x26; y_{i+1}^1 x_i^1 &#x26; y_{i+1}^1 y_i^1 &#x26; y_{i+1}^1 &#x26; x_i^1 &#x26; y_i^1 &#x26; 1 \\\\\n    \\vdots &#x26; \\vdots &#x26; \\vdots &#x26; \\vdots &#x26; \\vdots &#x26; \\vdots &#x26; \\vdots &#x26; \\vdots &#x26;  \\vdots \\\\\n    x_{i+1}^8 x_i^8 &#x26; x_{i+1}^8 y_i^8 &#x26; x_{i+1}^8 &#x26; y_{i+1}^8 x_i^8 &#x26; y_{i+1}^8 y_i^8 &#x26; y_{i+1}^8 &#x26; x_i^8 &#x26; y_i^8 &#x26; 1\n\\end{bmatrix}\n\\begin{bmatrix}\n    f_{11} \\\\\n    f_{12} \\\\\n    f_{13} \\\\\n    f_{21} \\\\\n    f_{22} \\\\\n    f_{23} \\\\\n    f_{31} \\\\\n    f_{32} \\\\\n    f_{33}\n\\end{bmatrix}\n= 0,\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:10.8001em;vertical-align:-5.1501em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.35em;\">\u003Cspan style=\"top:-4.35em;\">\u003Cspan class=\"pstrut\" style=\"height:6.2em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:4.200em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"4.200em\" viewBox=\"0 0 667 4200\">\u003Cpath d=\"M403 1759 V84 H666 V0 H319 V1759 v600 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v600 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.85em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.317em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8141em;\">\u003Cspan style=\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2587em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.38em;\">\u003Cspan style=\"top:-5.2275em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.3675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">⋮\u003C/span>\u003Cspan class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\">\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.1675em;\">\u003Cspan class=\"pstrut\" style=\"height:3.6875em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.88em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.35em;\">\u003Cspan style=\"top:-4.35em;\">\u003Cspan class=\"pstrut\" style=\"height:6.2em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:4.200em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"4.200em\" viewBox=\"0 0 667 4200\">\u003Cpath d=\"M347 1759 V0 H0 V84 H263 V1759 v600 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v600 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.85em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:5.6499em;\">\u003Cspan style=\"top:-7.6499em;\">\u003Cspan class=\"pstrut\" style=\"height:12.8em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:10.800em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"10.800em\" viewBox=\"0 0 667 10800\">\u003Cpath d=\"M403 1759 V84 H666 V0 H319 V1759 v7200 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v7200 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:5.1501em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:5.65em;\">\u003Cspan style=\"top:-7.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">11\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-6.61em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">12\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-5.41em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">13\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-4.21em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">21\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.01em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">22\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">23\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-0.61em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">31\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:0.59em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">32\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:1.79em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3011em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mtight\">33\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:5.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:5.6499em;\">\u003Cspan style=\"top:-7.6499em;\">\u003Cspan class=\"pstrut\" style=\"height:12.8em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:10.800em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"10.800em\" viewBox=\"0 0 667 10800\">\u003Cpath d=\"M347 1759 V0 H0 V84 H263 V1759 v7200 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v7200 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:5.1501em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\">\u003C/span>\u003Cspan class=\"mord\">0\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>which can be answered by solving the linear least squares using Singular Value Decomposition (SVD). This algorithm requires 8 keypoint correspondences exists, where \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsub>\u003Cmi>x\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmsub>\u003Cmi>y\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">(x_i, y_i)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> are the coordinates of the 8 keypoints selected from \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>K\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>, and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsub>\u003Cmi>x\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmsub>\u003Cmi>y\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">(x_{i+1}, y_{i+1})\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">x\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> are the coordinates of their corresponding keypoints in \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>K\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>. The coordinates should be normalized by shifting them around the mean of the points and enclosing them at a distance of \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsqrt>\u003Cmn>2\u003C/mn>\u003C/msqrt>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">\\sqrt{2}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1.04em;vertical-align:-0.1328em;\">\u003C/span>\u003Cspan class=\"mord sqrt\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.9072em;\">\u003Cspan class=\"svg-align\" style=\"top:-3em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\" style=\"padding-left:0.833em;\">\u003Cspan class=\"mord\">2\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-2.8672em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\">\u003Cpath d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.1328em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> from the new center.\u003C/p>\n\u003Cp>Given 8 keypoint correspondences, the code for computing \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span> is:\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">import\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> numpy \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">as\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> normalize\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(pt: np.ndarray):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Normalizes the given set of points.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    N \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt.shape[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    mean \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.mean(pt, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">axis\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    scale \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.sum(np.square(pt)) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">/\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> *\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> N)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    scale \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.sqrt(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> /\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> scale)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> scale \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> mean, scale\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> compute_fundamental_mat\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(pt1: np.ndarray, pt2: np.ndarray)-> np.ndarray:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Computes the fundamental matrix F using SVD.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    N \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt1.shape[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    norm_pt1, scale1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> normalize(pt1)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    norm_pt2, scale2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> normalize(pt2)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    T1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.array([\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [scale1, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> scale1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.mean(pt1[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, scale1, \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> scale1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.mean(pt1[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    ])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    T2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.array([\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [scale2, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> scale2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.mean(pt2[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, scale2, \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> scale2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.mean(pt2[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    ])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    A \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> range\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(N):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        x1, y1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> norm_pt1[i]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        x2, y2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> norm_pt2[i]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        a \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.array([x2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> x1, x2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> y1, x2, y2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> x1, y2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> y1, y2, x1, y1, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        A.append(a)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    A \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.array(A)  \u003C/span>\u003Cspan style=\"--shiki-light:#6A737D;--shiki-dark:#6A737D\"># (N, 9)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    U1, S1, V1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.linalg.svd(A)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V1[\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">,:].reshape(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">/=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> F[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    U2, S2, V2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.linalg.svd(F)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    S2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.diag(S2)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    S2[\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> U2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> S2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V2\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> T2.T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> T1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> F\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Ch3 id=\"ransac\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#ransac\">#\u003C/a>RANSAC\u003C/h3>\n\u003Cp>Our feature detection and tracking algorithms are not perfect, leading to several erroneous correspondences (outliers). Therefore, RANSAC is used to remove these outliers.\u003C/p>\n\u003Cp>RANSAC is an iterative algorithm terminating after a fixed number of iterations. At every iteration, it works in the following way:\u003C/p>\n\u003Cul>\n\u003Cli>Picks 8 keypoint correspondences from \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>K\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>K\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K_{i+1}\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/li>\n\u003Cli>Computes \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span> using Hartley’s 8-point algorithm mentioned above\u003C/li>\n\u003Cli>Determines how many of all other keypoints are inliers\u003C/li>\n\u003C/ul>\n\u003Cp>Finally, the \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span> with the maximum number of inliers will be used.\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> compute_ransac_error\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(F: np.ndarray, pt1: np.ndarray, pt2: np.ndarray):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    n \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt1.shape[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    p1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.hstack((pt1, np.ones((n, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">))))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    p2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.hstack((pt2, np.ones((n, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">))))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    e1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> p1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> F.T\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    e2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> p2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> F\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    error \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.sum(e2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> p1, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">axis\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">keepdims\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">True\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">**\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 2\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> /\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.sum(np.hstack((e1[:, :\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">], e2[:, :\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">**\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">axis\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#E36209;--shiki-dark:#FFAB70\">keepdims\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">True\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> error\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> find_fundamental_mat\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    pt1: np.ndarray, pt2: np.ndarray, threshold: \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">float\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> =\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0.05\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)-> np.ndarray:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Estimates the fundamental matrix using RANSAC.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    max_inliers \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    best_F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> None\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    confidence \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0.99\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    N \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> sys.maxsize\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    count \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    while\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> N \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">>\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> count:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        x, y \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> sample_eight_points(pt1, pt2)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> compute_fundamental_mat(x, y)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        error \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> compute_ransac_error(F, pt1, pt2)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        inliers \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> error \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">&#x3C;=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> threshold\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        n_inliers \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.sum(inliers)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">        if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> max_inliers \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.sum(inliers):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            max_inliers \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> n_inliers\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            best_F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> F.copy()\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        ratio \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> n_inliers \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">/\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> len\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(pt1)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">        if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.log(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> (ratio \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">**\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 8\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">==\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">            continue\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        N \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.log(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> confidence) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">/\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.log(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> (ratio \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">**\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 8\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        count \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">+=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> best_F\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> find_fundamental_mat(kp1, kp2, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0.05\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Cp>Then the problem is how to pick 8 keypoint correspondences (\u003Ccode>sample_eight_points\u003C/code>). While Hartley’s 8-point algorithm samples them randomly, to make the algorithm more robust to outliers, we can use the way mentioned \u003Ca href=\"https://www.crcv.ucf.edu/wp-content/uploads/2019/03/Lecture-13-FundamentalMatrix.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">here\u003C/a> (page 39) instead: uniformly dividing a frame into an \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmn>8\u003C/mn>\u003Cmo>×\u003C/mo>\u003Cmn>8\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">8 \\times 8\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord\">8\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">×\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">8\u003C/span>\u003C/span>\u003C/span>\u003C/span> grid, then randomly selecting 8 grid cells and picking one pair of corresponding keypoints from each grid cell.\u003C/p>\n\u003Ch2 id=\"essential-matrix\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#essential-matrix\">#\u003C/a>Essential Matrix\u003C/h2>\n\u003Cp>Essential matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span> is another \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmn>3\u003C/mn>\u003Cmo>×\u003C/mo>\u003Cmn>3\u003C/mn>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">3 \\times 3\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord\">3\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">×\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6444em;\">\u003C/span>\u003Cspan class=\"mord\">3\u003C/span>\u003C/span>\u003C/span>\u003C/span> matrix. But unlike \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span>, \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span> assumes that the cameras obey the pinhole model. More specifically, given the camera calibration matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>K\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">K\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003C/span>\u003C/span>\u003C/span>, \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmsup>\u003Cmi>K\u003C/mi>\u003Cmi>T\u003C/mi>\u003C/msup>\u003Cmi>F\u003C/mi>\u003Cmi>K\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E = K^T F K\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8413em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8413em;\">\u003Cspan style=\"top:-3.063em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K\u003C/span>\u003C/span>\u003C/span>\u003C/span>, which also can be solved using SVD.\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> find_essential_mat\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(K: np.ndarray, F: np.ndarray)-> np.ndarray:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Estimates the essential matrix.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    E \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> K.T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> F \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> K\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    U, S, V \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.linalg.svd(E)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\" data-highlighted-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    S \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.asarray([\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\" data-highlighted-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\" data-highlighted-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\" data-highlighted-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\" data-highlighted-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    ])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\" data-highlighted-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    E \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> U \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> S \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    E \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> E \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">/\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.linalg.norm(E)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> E\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">E \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> find_essential_mat(K, F)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Cp>Note that the singular values of \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span> are not necessarily \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmn>0\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">(1, 1, 0)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">1\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">1\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">0\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> due to the noise in K. Thus \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span> should be reconstructed with \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmn>1\u003C/mn>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmn>0\u003C/mn>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">(1, 1, 0)\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">1\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">1\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">0\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> singular values:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmi>U\u003C/mi>\u003Cmrow>\u003Cmo fence=\"true\">[\u003C/mo>\u003Cmtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\">\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>1\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>1\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003Cmtr>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003Cmtd>\u003Cmstyle scriptlevel=\"0\" displaystyle=\"false\">\u003Cmn>0\u003C/mn>\u003C/mstyle>\u003C/mtd>\u003C/mtr>\u003C/mtable>\u003Cmo fence=\"true\">]\u003C/mo>\u003C/mrow>\u003Cmsup>\u003Cmi>V\u003C/mi>\u003Cmi mathvariant=\"normal\">⊤\u003C/mi>\u003C/msup>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E = U\n\n\\begin{bmatrix}\n    1 &#x26; 0 &#x26; 0 \\\\\n    0 &#x26; 1 &#x26; 0 \\\\\n    0 &#x26; 0 &#x26; 0 \\\\\n\\end{bmatrix}\n\nV^\\top\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:3.6em;vertical-align:-1.55em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"minner\">\u003Cspan class=\"mopen\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.05em;\">\u003Cspan class=\"pstrut\" style=\"height:5.6em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:3.600em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"3.600em\" viewBox=\"0 0 667 3600\">\u003Cpath d=\"M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v0 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mtable\">\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.21em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.01em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.21em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.01em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">1\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"arraycolsep\" style=\"width:0.5em;\">\u003C/span>\u003Cspan class=\"col-align-c\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.21em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-3.01em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003Cspan style=\"top:-1.81em;\">\u003Cspan class=\"pstrut\" style=\"height:3em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord\">0\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">\u003Cspan class=\"delimsizing mult\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:2.05em;\">\u003Cspan style=\"top:-4.05em;\">\u003Cspan class=\"pstrut\" style=\"height:5.6em;\">\u003C/span>\u003Cspan style=\"width:0.667em;height:3.600em;\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"3.600em\" viewBox=\"0 0 667 3600\">\u003Cpath d=\"M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v0 v1759 h84z\">\u003C/path>\u003C/svg>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:1.55em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.8991em;\">\u003Cspan style=\"top:-3.113em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">⊤\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Chr>\n\u003Cp>Now we have successfully estimated the essential matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span> manually, looks cool! However, this can also be done with the help of OpenCV, and all you need is one line:\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">E, mask \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cv2.findEssentialMat(kp2, kp1, K, cv2.\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">RANSAC\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0.999\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0.3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">None\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Cp>OpenCV uses \u003Ca href=\"https://www-users.cse.umn.edu/~hspark/CSci5980/nister.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">Nistér’s 5-point algorithm\u003C/a>, a more recent approach that is shown to give better results, to compute \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span>. It requires the minimum number of keypoints possible since \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span> has only 5 degrees of freedom (\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>F\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">F\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F\u003C/span>\u003C/span>\u003C/span>\u003C/span> has 7 degrees of freedom, \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span> has only 5 as it takes camera parameters into account).\u003C/p>\n\u003Ch2 id=\"camera-pose\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#camera-pose\">#\u003C/a>Camera Pose\u003C/h2>\n\u003Cp>Just follow \u003Ca href=\"https://cmsc426.github.io/sfm/#essential\" rel=\"noopener noreferrer\" target=\"_blank\">here\u003C/a> to recover the camera rotation matrix \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>R\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">R_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> and translation vector \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmsub>\u003Cmi>t\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">t_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span> from \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>E\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">E\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E\u003C/span>\u003C/span>\u003C/span>\u003C/span>.\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> linear_triangulation\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    T1: np.ndarray,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    R1: np.ndarray,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    T2: np.ndarray,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    R2: np.ndarray,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    pt1: np.ndarray,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    pt2: np.ndarray,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    K: np.ndarray,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)-> np.ndarray:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Linear triangulation.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    P1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> K \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.hstack((R1, \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">R1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> T1))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    P2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> K \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.hstack((R2, \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">R2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> T2))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    X \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> range\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">len\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(pt1)):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        x1, x2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> pt1[i], pt2[i]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        A1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> x1[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P1[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P1[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        A2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> x1[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P1[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P1[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        A3 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> x2[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P2[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P2[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        A4 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> x2[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">*\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P2[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> P2[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, :]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        A \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.asarray([A1, A2, A3, A4])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        U, S, V \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.linalg.svd(A)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        V \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        V \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">/\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V[\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        X.append(V)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.asarray(X)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">def\u003C/span>\u003Cspan style=\"--shiki-light:#6F42C1;--shiki-dark:#B392F0\"> recover_pose\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(E: np.ndarray, pt1, pt2, K: np.ndarray):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">    \"\"\"Recovers the camera pose.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    W \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.asarray([\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">,  \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">],\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        [\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">,  \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    ])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    U, S, V \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.linalg.svd(E)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    poses \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"T1\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:  U[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">].reshape(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">),\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"T2\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">: \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">U[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">].reshape(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">),\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"T3\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:  U[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">].reshape(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">),\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"T4\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">: \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">U[:, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">].reshape(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">),\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"R1\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:  U \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> W   \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"R2\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:  U \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> W   \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"R3\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:  U \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> W.T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V,\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">        \"R4\"\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:  U \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> W.T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> V\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> range\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">5\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        T, R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"T\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)], poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"R\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">        if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.linalg.det(R) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">T\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">R\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"T\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)], poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"R\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> T, R\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        I \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.identity(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        M \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.hstack((I, T.reshape(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)))\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"P\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> K \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> M\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    max_Z, rt_idx \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> range\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">5\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        T1, R1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"T\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)], poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"R\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#6A737D;--shiki-dark:#6A737D\">        # ---------------------\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        T2, R2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.asarray([[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">],[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">],[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]]), np.identity(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        X \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> linear_triangulation(T2, R2, T1, R1, pt1, pt2, K)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        Z \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">        for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> range\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(X.shape[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">]):\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            x \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> X[j, :].reshape(\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">-\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">            if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> R1[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.subtract(x[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">], T1) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">>\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> and\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> x[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">>\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">                Z \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">+=\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#6A737D;--shiki-dark:#6A737D\">        # ---------------------\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">        if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> max_Z \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> Z:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">            max_Z, rt_idx \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> Z, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">str\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(i)\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">    cur_T, cur_R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"T\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> rt_idx], poses[\u003C/span>\u003Cspan style=\"--shiki-light:#032F62;--shiki-dark:#9ECBFF\">\"R\"\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> +\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> rt_idx]\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cur_T[\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">2\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">        cur_T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\"> -\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">cur_T\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">    return\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cur_T, cur_R\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\"> \u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">cur_T, cur_R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> recover_pose(E, kp1, kp2, K)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Chr>\n\u003Cp>Again, here is how to implement it in OpenCV:\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">kp1 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.array([pt \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> (idx, pt) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(kp1) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> mask[idx] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">==\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">kp2 \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.array([pt \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">for\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> (idx, pt) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">in\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">(kp2) \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">if\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> mask[idx] \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">==\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">])\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">_, cur_R, cur_t, _ \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cv2.recoverPose(E, kp2, kp1, K)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Ch2 id=\"trajectory\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#trajectory\">#\u003C/a>Trajectory\u003C/h2>\n\u003Cp>Denote the pose of the camera as \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>R\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">R\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003C/span>\u003C/span>\u003C/span> and \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmi>t\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">t\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6151em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003C/span>\u003C/span>\u003C/span>, which should be initialized as:\u003C/p>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">R, T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> np.identity(\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">), np.zeros((\u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">3\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">, \u003C/span>\u003Cspan style=\"--shiki-light:#005CC5;--shiki-dark:#79B8FF\">1\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">))\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Cp>We can update the trajectory of the camera by:\u003C/p>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>t\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmi>t\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmi>R\u003C/mi>\u003Cmsub>\u003Cmi>t\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">t = t + R t_i\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6151em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6984em;vertical-align:-0.0833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003Cspan class=\"mbin\">+\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2222em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\">t\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cspan class=\"katex-display\">\u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\">\u003Csemantics>\u003Cmrow>\u003Cmi>R\u003C/mi>\u003Cmo>=\u003C/mo>\u003Cmsub>\u003Cmi>R\u003C/mi>\u003Cmi>i\u003C/mi>\u003C/msub>\u003Cmi>R\u003C/mi>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">R = R_i R\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.6833em;\">\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003Cspan class=\"mrel\">=\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.2778em;\">\u003C/span>\u003C/span>\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.15em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\n\u003Cp>\u003C/p>\u003Cdiv class=\"language-python\">\u003Cspan class=\"lang\">python\u003C/span>\u003Cp>\u003C/p>\n\u003Cfigure data-rehype-pretty-code-figure=\"\">\u003Cpre tabindex=\"0\" data-language=\"python\" data-theme=\"github-light github-dark\">\u003Ccode data-language=\"python\" data-theme=\"github-light github-dark\" style=\"display: grid;\">\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> T \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">+\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cur_T\u003C/span>\u003C/span>\n\u003Cspan data-line=\"\">\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\">R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">=\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> cur_R \u003C/span>\u003Cspan style=\"--shiki-light:#D73A49;--shiki-dark:#F97583\">@\u003C/span>\u003Cspan style=\"--shiki-light:#24292E;--shiki-dark:#E1E4E8\"> R\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\u003C/figure>\n\u003C/div>\n\u003Cp>That’s it! We can now move to the next pair of frames \u003Cspan class=\"katex\">\u003Cspan class=\"katex-mathml\">\u003Cmath xmlns=\"http://www.w3.org/1998/Math/MathML\">\u003Csemantics>\u003Cmrow>\u003Cmo stretchy=\"false\">(\u003C/mo>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>1\u003C/mn>\u003C/mrow>\u003C/msub>\u003Cmo separator=\"true\">,\u003C/mo>\u003Cmsub>\u003Cmi>I\u003C/mi>\u003Cmrow>\u003Cmi>i\u003C/mi>\u003Cmo>+\u003C/mo>\u003Cmn>2\u003C/mn>\u003C/mrow>\u003C/msub>\u003Cmo stretchy=\"false\">)\u003C/mo>\u003C/mrow>\u003Cannotation encoding=\"application/x-tex\">(I_{i+1}, I_{i+2})\u003C/annotation>\u003C/semantics>\u003C/math>\u003C/span>\u003Cspan class=\"katex-html\" aria-hidden=\"true\">\u003Cspan class=\"base\">\u003Cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\">\u003C/span>\u003Cspan class=\"mopen\">(\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">1\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mpunct\">,\u003C/span>\u003Cspan class=\"mspace\" style=\"margin-right:0.1667em;\">\u003C/span>\u003Cspan class=\"mord\">\u003Cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I\u003C/span>\u003Cspan class=\"msupsub\">\u003Cspan class=\"vlist-t vlist-t2\">\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.3117em;\">\u003Cspan style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\">\u003Cspan class=\"pstrut\" style=\"height:2.7em;\">\u003C/span>\u003Cspan class=\"sizing reset-size6 size3 mtight\">\u003Cspan class=\"mord mtight\">\u003Cspan class=\"mord mathnormal mtight\">i\u003C/span>\u003Cspan class=\"mbin mtight\">+\u003C/span>\u003Cspan class=\"mord mtight\">2\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"vlist-s\">​\u003C/span>\u003C/span>\u003Cspan class=\"vlist-r\">\u003Cspan class=\"vlist\" style=\"height:0.2083em;\">\u003Cspan>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"mclose\">)\u003C/span>\u003C/span>\u003C/span>\u003C/span> and repeat from \u003Ca href=\"#feature-detection\">here\u003C/a>.\u003C/p>\n\u003Cp>Of course, there are many details and optimizations (e.g. bundle adjustment) that can be added to improve the accuracy and performance of the VO system, but this should give a good starting point for building a monocular VO system.\u003C/p>\n\u003Ch2 id=\"references\">\u003Ca aria-hidden=\"true\" tabindex=\"-1\" class=\"header-anchor\" href=\"#references\">#\u003C/a>References\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://cmsc426.github.io/sfm/\" rel=\"noopener noreferrer\" target=\"_blank\">Structure from Motion (University of Maryland)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://www.cs.cmu.edu/~16385/s17/Slides/12.4_8Point_Algorithm.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">The 8-point algorithm (Carnegie Mellon University)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://www.crcv.ucf.edu/wp-content/uploads/2019/03/Lecture-13-FundamentalMatrix.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">Fundamental Matrix (University of Central Florida)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://www-users.cse.umn.edu/~hspark/CSci5980/nister.pdf\" rel=\"noopener noreferrer\" target=\"_blank\">An Efficient Solution to the Five-Point Relative Pose Problem\u003C/a>. \u003Cem>David Nistér\u003C/em>. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2004.\u003C/li>\n\u003Cli>\u003Ca href=\"https://avisingh599.github.io/vision/monocular-vo/\" rel=\"noopener noreferrer\" target=\"_blank\">Monocular Visual Odometry using OpenCV\u003C/a>\u003C/li>\n\u003C/ul>",{"headings":141,"localImagePaths":170,"remoteImagePaths":171,"frontmatter":172,"imagePaths":174},[142,145,148,151,154,157,160,163,166,169],{"depth":23,"slug":143,"text":144},"problem","#Problem",{"depth":23,"slug":146,"text":147},"feature-detection","#Feature Detection",{"depth":23,"slug":149,"text":150},"feature-tracking","#Feature Tracking",{"depth":23,"slug":152,"text":153},"fundamental-matrix","#Fundamental Matrix",{"depth":90,"slug":155,"text":156},"_8-point-algorithm","#8-Point Algorithm",{"depth":90,"slug":158,"text":159},"ransac","#RANSAC",{"depth":23,"slug":161,"text":162},"essential-matrix","#Essential Matrix",{"depth":23,"slug":164,"text":165},"camera-pose","#Camera Pose",{"depth":23,"slug":167,"text":168},"trajectory","#Trajectory",{"depth":23,"slug":122,"text":123},[],[],{"title":132,"tags":173},[134],[]]